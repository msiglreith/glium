<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="Source to the Rust file `src/lib.rs`.">
    <meta name="keywords" content="rust, rustlang, rust-lang">

    <title>lib.rs.html -- source</title>

    <link rel="stylesheet" type="text/css" href="../../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        
        
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press 'S' to search, '?' for more options..."
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content source"><pre class="line-numbers"><span id="1">   1</span>
<span id="2">   2</span>
<span id="3">   3</span>
<span id="4">   4</span>
<span id="5">   5</span>
<span id="6">   6</span>
<span id="7">   7</span>
<span id="8">   8</span>
<span id="9">   9</span>
<span id="10">  10</span>
<span id="11">  11</span>
<span id="12">  12</span>
<span id="13">  13</span>
<span id="14">  14</span>
<span id="15">  15</span>
<span id="16">  16</span>
<span id="17">  17</span>
<span id="18">  18</span>
<span id="19">  19</span>
<span id="20">  20</span>
<span id="21">  21</span>
<span id="22">  22</span>
<span id="23">  23</span>
<span id="24">  24</span>
<span id="25">  25</span>
<span id="26">  26</span>
<span id="27">  27</span>
<span id="28">  28</span>
<span id="29">  29</span>
<span id="30">  30</span>
<span id="31">  31</span>
<span id="32">  32</span>
<span id="33">  33</span>
<span id="34">  34</span>
<span id="35">  35</span>
<span id="36">  36</span>
<span id="37">  37</span>
<span id="38">  38</span>
<span id="39">  39</span>
<span id="40">  40</span>
<span id="41">  41</span>
<span id="42">  42</span>
<span id="43">  43</span>
<span id="44">  44</span>
<span id="45">  45</span>
<span id="46">  46</span>
<span id="47">  47</span>
<span id="48">  48</span>
<span id="49">  49</span>
<span id="50">  50</span>
<span id="51">  51</span>
<span id="52">  52</span>
<span id="53">  53</span>
<span id="54">  54</span>
<span id="55">  55</span>
<span id="56">  56</span>
<span id="57">  57</span>
<span id="58">  58</span>
<span id="59">  59</span>
<span id="60">  60</span>
<span id="61">  61</span>
<span id="62">  62</span>
<span id="63">  63</span>
<span id="64">  64</span>
<span id="65">  65</span>
<span id="66">  66</span>
<span id="67">  67</span>
<span id="68">  68</span>
<span id="69">  69</span>
<span id="70">  70</span>
<span id="71">  71</span>
<span id="72">  72</span>
<span id="73">  73</span>
<span id="74">  74</span>
<span id="75">  75</span>
<span id="76">  76</span>
<span id="77">  77</span>
<span id="78">  78</span>
<span id="79">  79</span>
<span id="80">  80</span>
<span id="81">  81</span>
<span id="82">  82</span>
<span id="83">  83</span>
<span id="84">  84</span>
<span id="85">  85</span>
<span id="86">  86</span>
<span id="87">  87</span>
<span id="88">  88</span>
<span id="89">  89</span>
<span id="90">  90</span>
<span id="91">  91</span>
<span id="92">  92</span>
<span id="93">  93</span>
<span id="94">  94</span>
<span id="95">  95</span>
<span id="96">  96</span>
<span id="97">  97</span>
<span id="98">  98</span>
<span id="99">  99</span>
<span id="100"> 100</span>
<span id="101"> 101</span>
<span id="102"> 102</span>
<span id="103"> 103</span>
<span id="104"> 104</span>
<span id="105"> 105</span>
<span id="106"> 106</span>
<span id="107"> 107</span>
<span id="108"> 108</span>
<span id="109"> 109</span>
<span id="110"> 110</span>
<span id="111"> 111</span>
<span id="112"> 112</span>
<span id="113"> 113</span>
<span id="114"> 114</span>
<span id="115"> 115</span>
<span id="116"> 116</span>
<span id="117"> 117</span>
<span id="118"> 118</span>
<span id="119"> 119</span>
<span id="120"> 120</span>
<span id="121"> 121</span>
<span id="122"> 122</span>
<span id="123"> 123</span>
<span id="124"> 124</span>
<span id="125"> 125</span>
<span id="126"> 126</span>
<span id="127"> 127</span>
<span id="128"> 128</span>
<span id="129"> 129</span>
<span id="130"> 130</span>
<span id="131"> 131</span>
<span id="132"> 132</span>
<span id="133"> 133</span>
<span id="134"> 134</span>
<span id="135"> 135</span>
<span id="136"> 136</span>
<span id="137"> 137</span>
<span id="138"> 138</span>
<span id="139"> 139</span>
<span id="140"> 140</span>
<span id="141"> 141</span>
<span id="142"> 142</span>
<span id="143"> 143</span>
<span id="144"> 144</span>
<span id="145"> 145</span>
<span id="146"> 146</span>
<span id="147"> 147</span>
<span id="148"> 148</span>
<span id="149"> 149</span>
<span id="150"> 150</span>
<span id="151"> 151</span>
<span id="152"> 152</span>
<span id="153"> 153</span>
<span id="154"> 154</span>
<span id="155"> 155</span>
<span id="156"> 156</span>
<span id="157"> 157</span>
<span id="158"> 158</span>
<span id="159"> 159</span>
<span id="160"> 160</span>
<span id="161"> 161</span>
<span id="162"> 162</span>
<span id="163"> 163</span>
<span id="164"> 164</span>
<span id="165"> 165</span>
<span id="166"> 166</span>
<span id="167"> 167</span>
<span id="168"> 168</span>
<span id="169"> 169</span>
<span id="170"> 170</span>
<span id="171"> 171</span>
<span id="172"> 172</span>
<span id="173"> 173</span>
<span id="174"> 174</span>
<span id="175"> 175</span>
<span id="176"> 176</span>
<span id="177"> 177</span>
<span id="178"> 178</span>
<span id="179"> 179</span>
<span id="180"> 180</span>
<span id="181"> 181</span>
<span id="182"> 182</span>
<span id="183"> 183</span>
<span id="184"> 184</span>
<span id="185"> 185</span>
<span id="186"> 186</span>
<span id="187"> 187</span>
<span id="188"> 188</span>
<span id="189"> 189</span>
<span id="190"> 190</span>
<span id="191"> 191</span>
<span id="192"> 192</span>
<span id="193"> 193</span>
<span id="194"> 194</span>
<span id="195"> 195</span>
<span id="196"> 196</span>
<span id="197"> 197</span>
<span id="198"> 198</span>
<span id="199"> 199</span>
<span id="200"> 200</span>
<span id="201"> 201</span>
<span id="202"> 202</span>
<span id="203"> 203</span>
<span id="204"> 204</span>
<span id="205"> 205</span>
<span id="206"> 206</span>
<span id="207"> 207</span>
<span id="208"> 208</span>
<span id="209"> 209</span>
<span id="210"> 210</span>
<span id="211"> 211</span>
<span id="212"> 212</span>
<span id="213"> 213</span>
<span id="214"> 214</span>
<span id="215"> 215</span>
<span id="216"> 216</span>
<span id="217"> 217</span>
<span id="218"> 218</span>
<span id="219"> 219</span>
<span id="220"> 220</span>
<span id="221"> 221</span>
<span id="222"> 222</span>
<span id="223"> 223</span>
<span id="224"> 224</span>
<span id="225"> 225</span>
<span id="226"> 226</span>
<span id="227"> 227</span>
<span id="228"> 228</span>
<span id="229"> 229</span>
<span id="230"> 230</span>
<span id="231"> 231</span>
<span id="232"> 232</span>
<span id="233"> 233</span>
<span id="234"> 234</span>
<span id="235"> 235</span>
<span id="236"> 236</span>
<span id="237"> 237</span>
<span id="238"> 238</span>
<span id="239"> 239</span>
<span id="240"> 240</span>
<span id="241"> 241</span>
<span id="242"> 242</span>
<span id="243"> 243</span>
<span id="244"> 244</span>
<span id="245"> 245</span>
<span id="246"> 246</span>
<span id="247"> 247</span>
<span id="248"> 248</span>
<span id="249"> 249</span>
<span id="250"> 250</span>
<span id="251"> 251</span>
<span id="252"> 252</span>
<span id="253"> 253</span>
<span id="254"> 254</span>
<span id="255"> 255</span>
<span id="256"> 256</span>
<span id="257"> 257</span>
<span id="258"> 258</span>
<span id="259"> 259</span>
<span id="260"> 260</span>
<span id="261"> 261</span>
<span id="262"> 262</span>
<span id="263"> 263</span>
<span id="264"> 264</span>
<span id="265"> 265</span>
<span id="266"> 266</span>
<span id="267"> 267</span>
<span id="268"> 268</span>
<span id="269"> 269</span>
<span id="270"> 270</span>
<span id="271"> 271</span>
<span id="272"> 272</span>
<span id="273"> 273</span>
<span id="274"> 274</span>
<span id="275"> 275</span>
<span id="276"> 276</span>
<span id="277"> 277</span>
<span id="278"> 278</span>
<span id="279"> 279</span>
<span id="280"> 280</span>
<span id="281"> 281</span>
<span id="282"> 282</span>
<span id="283"> 283</span>
<span id="284"> 284</span>
<span id="285"> 285</span>
<span id="286"> 286</span>
<span id="287"> 287</span>
<span id="288"> 288</span>
<span id="289"> 289</span>
<span id="290"> 290</span>
<span id="291"> 291</span>
<span id="292"> 292</span>
<span id="293"> 293</span>
<span id="294"> 294</span>
<span id="295"> 295</span>
<span id="296"> 296</span>
<span id="297"> 297</span>
<span id="298"> 298</span>
<span id="299"> 299</span>
<span id="300"> 300</span>
<span id="301"> 301</span>
<span id="302"> 302</span>
<span id="303"> 303</span>
<span id="304"> 304</span>
<span id="305"> 305</span>
<span id="306"> 306</span>
<span id="307"> 307</span>
<span id="308"> 308</span>
<span id="309"> 309</span>
<span id="310"> 310</span>
<span id="311"> 311</span>
<span id="312"> 312</span>
<span id="313"> 313</span>
<span id="314"> 314</span>
<span id="315"> 315</span>
<span id="316"> 316</span>
<span id="317"> 317</span>
<span id="318"> 318</span>
<span id="319"> 319</span>
<span id="320"> 320</span>
<span id="321"> 321</span>
<span id="322"> 322</span>
<span id="323"> 323</span>
<span id="324"> 324</span>
<span id="325"> 325</span>
<span id="326"> 326</span>
<span id="327"> 327</span>
<span id="328"> 328</span>
<span id="329"> 329</span>
<span id="330"> 330</span>
<span id="331"> 331</span>
<span id="332"> 332</span>
<span id="333"> 333</span>
<span id="334"> 334</span>
<span id="335"> 335</span>
<span id="336"> 336</span>
<span id="337"> 337</span>
<span id="338"> 338</span>
<span id="339"> 339</span>
<span id="340"> 340</span>
<span id="341"> 341</span>
<span id="342"> 342</span>
<span id="343"> 343</span>
<span id="344"> 344</span>
<span id="345"> 345</span>
<span id="346"> 346</span>
<span id="347"> 347</span>
<span id="348"> 348</span>
<span id="349"> 349</span>
<span id="350"> 350</span>
<span id="351"> 351</span>
<span id="352"> 352</span>
<span id="353"> 353</span>
<span id="354"> 354</span>
<span id="355"> 355</span>
<span id="356"> 356</span>
<span id="357"> 357</span>
<span id="358"> 358</span>
<span id="359"> 359</span>
<span id="360"> 360</span>
<span id="361"> 361</span>
<span id="362"> 362</span>
<span id="363"> 363</span>
<span id="364"> 364</span>
<span id="365"> 365</span>
<span id="366"> 366</span>
<span id="367"> 367</span>
<span id="368"> 368</span>
<span id="369"> 369</span>
<span id="370"> 370</span>
<span id="371"> 371</span>
<span id="372"> 372</span>
<span id="373"> 373</span>
<span id="374"> 374</span>
<span id="375"> 375</span>
<span id="376"> 376</span>
<span id="377"> 377</span>
<span id="378"> 378</span>
<span id="379"> 379</span>
<span id="380"> 380</span>
<span id="381"> 381</span>
<span id="382"> 382</span>
<span id="383"> 383</span>
<span id="384"> 384</span>
<span id="385"> 385</span>
<span id="386"> 386</span>
<span id="387"> 387</span>
<span id="388"> 388</span>
<span id="389"> 389</span>
<span id="390"> 390</span>
<span id="391"> 391</span>
<span id="392"> 392</span>
<span id="393"> 393</span>
<span id="394"> 394</span>
<span id="395"> 395</span>
<span id="396"> 396</span>
<span id="397"> 397</span>
<span id="398"> 398</span>
<span id="399"> 399</span>
<span id="400"> 400</span>
<span id="401"> 401</span>
<span id="402"> 402</span>
<span id="403"> 403</span>
<span id="404"> 404</span>
<span id="405"> 405</span>
<span id="406"> 406</span>
<span id="407"> 407</span>
<span id="408"> 408</span>
<span id="409"> 409</span>
<span id="410"> 410</span>
<span id="411"> 411</span>
<span id="412"> 412</span>
<span id="413"> 413</span>
<span id="414"> 414</span>
<span id="415"> 415</span>
<span id="416"> 416</span>
<span id="417"> 417</span>
<span id="418"> 418</span>
<span id="419"> 419</span>
<span id="420"> 420</span>
<span id="421"> 421</span>
<span id="422"> 422</span>
<span id="423"> 423</span>
<span id="424"> 424</span>
<span id="425"> 425</span>
<span id="426"> 426</span>
<span id="427"> 427</span>
<span id="428"> 428</span>
<span id="429"> 429</span>
<span id="430"> 430</span>
<span id="431"> 431</span>
<span id="432"> 432</span>
<span id="433"> 433</span>
<span id="434"> 434</span>
<span id="435"> 435</span>
<span id="436"> 436</span>
<span id="437"> 437</span>
<span id="438"> 438</span>
<span id="439"> 439</span>
<span id="440"> 440</span>
<span id="441"> 441</span>
<span id="442"> 442</span>
<span id="443"> 443</span>
<span id="444"> 444</span>
<span id="445"> 445</span>
<span id="446"> 446</span>
<span id="447"> 447</span>
<span id="448"> 448</span>
<span id="449"> 449</span>
<span id="450"> 450</span>
<span id="451"> 451</span>
<span id="452"> 452</span>
<span id="453"> 453</span>
<span id="454"> 454</span>
<span id="455"> 455</span>
<span id="456"> 456</span>
<span id="457"> 457</span>
<span id="458"> 458</span>
<span id="459"> 459</span>
<span id="460"> 460</span>
<span id="461"> 461</span>
<span id="462"> 462</span>
<span id="463"> 463</span>
<span id="464"> 464</span>
<span id="465"> 465</span>
<span id="466"> 466</span>
<span id="467"> 467</span>
<span id="468"> 468</span>
<span id="469"> 469</span>
<span id="470"> 470</span>
<span id="471"> 471</span>
<span id="472"> 472</span>
<span id="473"> 473</span>
<span id="474"> 474</span>
<span id="475"> 475</span>
<span id="476"> 476</span>
<span id="477"> 477</span>
<span id="478"> 478</span>
<span id="479"> 479</span>
<span id="480"> 480</span>
<span id="481"> 481</span>
<span id="482"> 482</span>
<span id="483"> 483</span>
<span id="484"> 484</span>
<span id="485"> 485</span>
<span id="486"> 486</span>
<span id="487"> 487</span>
<span id="488"> 488</span>
<span id="489"> 489</span>
<span id="490"> 490</span>
<span id="491"> 491</span>
<span id="492"> 492</span>
<span id="493"> 493</span>
<span id="494"> 494</span>
<span id="495"> 495</span>
<span id="496"> 496</span>
<span id="497"> 497</span>
<span id="498"> 498</span>
<span id="499"> 499</span>
<span id="500"> 500</span>
<span id="501"> 501</span>
<span id="502"> 502</span>
<span id="503"> 503</span>
<span id="504"> 504</span>
<span id="505"> 505</span>
<span id="506"> 506</span>
<span id="507"> 507</span>
<span id="508"> 508</span>
<span id="509"> 509</span>
<span id="510"> 510</span>
<span id="511"> 511</span>
<span id="512"> 512</span>
<span id="513"> 513</span>
<span id="514"> 514</span>
<span id="515"> 515</span>
<span id="516"> 516</span>
<span id="517"> 517</span>
<span id="518"> 518</span>
<span id="519"> 519</span>
<span id="520"> 520</span>
<span id="521"> 521</span>
<span id="522"> 522</span>
<span id="523"> 523</span>
<span id="524"> 524</span>
<span id="525"> 525</span>
<span id="526"> 526</span>
<span id="527"> 527</span>
<span id="528"> 528</span>
<span id="529"> 529</span>
<span id="530"> 530</span>
<span id="531"> 531</span>
<span id="532"> 532</span>
<span id="533"> 533</span>
<span id="534"> 534</span>
<span id="535"> 535</span>
<span id="536"> 536</span>
<span id="537"> 537</span>
<span id="538"> 538</span>
<span id="539"> 539</span>
<span id="540"> 540</span>
<span id="541"> 541</span>
<span id="542"> 542</span>
<span id="543"> 543</span>
<span id="544"> 544</span>
<span id="545"> 545</span>
<span id="546"> 546</span>
<span id="547"> 547</span>
<span id="548"> 548</span>
<span id="549"> 549</span>
<span id="550"> 550</span>
<span id="551"> 551</span>
<span id="552"> 552</span>
<span id="553"> 553</span>
<span id="554"> 554</span>
<span id="555"> 555</span>
<span id="556"> 556</span>
<span id="557"> 557</span>
<span id="558"> 558</span>
<span id="559"> 559</span>
<span id="560"> 560</span>
<span id="561"> 561</span>
<span id="562"> 562</span>
<span id="563"> 563</span>
<span id="564"> 564</span>
<span id="565"> 565</span>
<span id="566"> 566</span>
<span id="567"> 567</span>
<span id="568"> 568</span>
<span id="569"> 569</span>
<span id="570"> 570</span>
<span id="571"> 571</span>
<span id="572"> 572</span>
<span id="573"> 573</span>
<span id="574"> 574</span>
<span id="575"> 575</span>
<span id="576"> 576</span>
<span id="577"> 577</span>
<span id="578"> 578</span>
<span id="579"> 579</span>
<span id="580"> 580</span>
<span id="581"> 581</span>
<span id="582"> 582</span>
<span id="583"> 583</span>
<span id="584"> 584</span>
<span id="585"> 585</span>
<span id="586"> 586</span>
<span id="587"> 587</span>
<span id="588"> 588</span>
<span id="589"> 589</span>
<span id="590"> 590</span>
<span id="591"> 591</span>
<span id="592"> 592</span>
<span id="593"> 593</span>
<span id="594"> 594</span>
<span id="595"> 595</span>
<span id="596"> 596</span>
<span id="597"> 597</span>
<span id="598"> 598</span>
<span id="599"> 599</span>
<span id="600"> 600</span>
<span id="601"> 601</span>
<span id="602"> 602</span>
<span id="603"> 603</span>
<span id="604"> 604</span>
<span id="605"> 605</span>
<span id="606"> 606</span>
<span id="607"> 607</span>
<span id="608"> 608</span>
<span id="609"> 609</span>
<span id="610"> 610</span>
<span id="611"> 611</span>
<span id="612"> 612</span>
<span id="613"> 613</span>
<span id="614"> 614</span>
<span id="615"> 615</span>
<span id="616"> 616</span>
<span id="617"> 617</span>
<span id="618"> 618</span>
<span id="619"> 619</span>
<span id="620"> 620</span>
<span id="621"> 621</span>
<span id="622"> 622</span>
<span id="623"> 623</span>
<span id="624"> 624</span>
<span id="625"> 625</span>
<span id="626"> 626</span>
<span id="627"> 627</span>
<span id="628"> 628</span>
<span id="629"> 629</span>
<span id="630"> 630</span>
<span id="631"> 631</span>
<span id="632"> 632</span>
<span id="633"> 633</span>
<span id="634"> 634</span>
<span id="635"> 635</span>
<span id="636"> 636</span>
<span id="637"> 637</span>
<span id="638"> 638</span>
<span id="639"> 639</span>
<span id="640"> 640</span>
<span id="641"> 641</span>
<span id="642"> 642</span>
<span id="643"> 643</span>
<span id="644"> 644</span>
<span id="645"> 645</span>
<span id="646"> 646</span>
<span id="647"> 647</span>
<span id="648"> 648</span>
<span id="649"> 649</span>
<span id="650"> 650</span>
<span id="651"> 651</span>
<span id="652"> 652</span>
<span id="653"> 653</span>
<span id="654"> 654</span>
<span id="655"> 655</span>
<span id="656"> 656</span>
<span id="657"> 657</span>
<span id="658"> 658</span>
<span id="659"> 659</span>
<span id="660"> 660</span>
<span id="661"> 661</span>
<span id="662"> 662</span>
<span id="663"> 663</span>
<span id="664"> 664</span>
<span id="665"> 665</span>
<span id="666"> 666</span>
<span id="667"> 667</span>
<span id="668"> 668</span>
<span id="669"> 669</span>
<span id="670"> 670</span>
<span id="671"> 671</span>
<span id="672"> 672</span>
<span id="673"> 673</span>
<span id="674"> 674</span>
<span id="675"> 675</span>
<span id="676"> 676</span>
<span id="677"> 677</span>
<span id="678"> 678</span>
<span id="679"> 679</span>
<span id="680"> 680</span>
<span id="681"> 681</span>
<span id="682"> 682</span>
<span id="683"> 683</span>
<span id="684"> 684</span>
<span id="685"> 685</span>
<span id="686"> 686</span>
<span id="687"> 687</span>
<span id="688"> 688</span>
<span id="689"> 689</span>
<span id="690"> 690</span>
<span id="691"> 691</span>
<span id="692"> 692</span>
<span id="693"> 693</span>
<span id="694"> 694</span>
<span id="695"> 695</span>
<span id="696"> 696</span>
<span id="697"> 697</span>
<span id="698"> 698</span>
<span id="699"> 699</span>
<span id="700"> 700</span>
<span id="701"> 701</span>
<span id="702"> 702</span>
<span id="703"> 703</span>
<span id="704"> 704</span>
<span id="705"> 705</span>
<span id="706"> 706</span>
<span id="707"> 707</span>
<span id="708"> 708</span>
<span id="709"> 709</span>
<span id="710"> 710</span>
<span id="711"> 711</span>
<span id="712"> 712</span>
<span id="713"> 713</span>
<span id="714"> 714</span>
<span id="715"> 715</span>
<span id="716"> 716</span>
<span id="717"> 717</span>
<span id="718"> 718</span>
<span id="719"> 719</span>
<span id="720"> 720</span>
<span id="721"> 721</span>
<span id="722"> 722</span>
<span id="723"> 723</span>
<span id="724"> 724</span>
<span id="725"> 725</span>
<span id="726"> 726</span>
<span id="727"> 727</span>
<span id="728"> 728</span>
<span id="729"> 729</span>
<span id="730"> 730</span>
<span id="731"> 731</span>
<span id="732"> 732</span>
<span id="733"> 733</span>
<span id="734"> 734</span>
<span id="735"> 735</span>
<span id="736"> 736</span>
<span id="737"> 737</span>
<span id="738"> 738</span>
<span id="739"> 739</span>
<span id="740"> 740</span>
<span id="741"> 741</span>
<span id="742"> 742</span>
<span id="743"> 743</span>
<span id="744"> 744</span>
<span id="745"> 745</span>
<span id="746"> 746</span>
<span id="747"> 747</span>
<span id="748"> 748</span>
<span id="749"> 749</span>
<span id="750"> 750</span>
<span id="751"> 751</span>
<span id="752"> 752</span>
<span id="753"> 753</span>
<span id="754"> 754</span>
<span id="755"> 755</span>
<span id="756"> 756</span>
<span id="757"> 757</span>
<span id="758"> 758</span>
<span id="759"> 759</span>
<span id="760"> 760</span>
<span id="761"> 761</span>
<span id="762"> 762</span>
<span id="763"> 763</span>
<span id="764"> 764</span>
<span id="765"> 765</span>
<span id="766"> 766</span>
<span id="767"> 767</span>
<span id="768"> 768</span>
<span id="769"> 769</span>
<span id="770"> 770</span>
<span id="771"> 771</span>
<span id="772"> 772</span>
<span id="773"> 773</span>
<span id="774"> 774</span>
<span id="775"> 775</span>
<span id="776"> 776</span>
<span id="777"> 777</span>
<span id="778"> 778</span>
<span id="779"> 779</span>
<span id="780"> 780</span>
<span id="781"> 781</span>
<span id="782"> 782</span>
<span id="783"> 783</span>
<span id="784"> 784</span>
<span id="785"> 785</span>
<span id="786"> 786</span>
<span id="787"> 787</span>
<span id="788"> 788</span>
<span id="789"> 789</span>
<span id="790"> 790</span>
<span id="791"> 791</span>
<span id="792"> 792</span>
<span id="793"> 793</span>
<span id="794"> 794</span>
<span id="795"> 795</span>
<span id="796"> 796</span>
<span id="797"> 797</span>
<span id="798"> 798</span>
<span id="799"> 799</span>
<span id="800"> 800</span>
<span id="801"> 801</span>
<span id="802"> 802</span>
<span id="803"> 803</span>
<span id="804"> 804</span>
<span id="805"> 805</span>
<span id="806"> 806</span>
<span id="807"> 807</span>
<span id="808"> 808</span>
<span id="809"> 809</span>
<span id="810"> 810</span>
<span id="811"> 811</span>
<span id="812"> 812</span>
<span id="813"> 813</span>
<span id="814"> 814</span>
<span id="815"> 815</span>
<span id="816"> 816</span>
<span id="817"> 817</span>
<span id="818"> 818</span>
<span id="819"> 819</span>
<span id="820"> 820</span>
<span id="821"> 821</span>
<span id="822"> 822</span>
<span id="823"> 823</span>
<span id="824"> 824</span>
<span id="825"> 825</span>
<span id="826"> 826</span>
<span id="827"> 827</span>
<span id="828"> 828</span>
<span id="829"> 829</span>
<span id="830"> 830</span>
<span id="831"> 831</span>
<span id="832"> 832</span>
<span id="833"> 833</span>
<span id="834"> 834</span>
<span id="835"> 835</span>
<span id="836"> 836</span>
<span id="837"> 837</span>
<span id="838"> 838</span>
<span id="839"> 839</span>
<span id="840"> 840</span>
<span id="841"> 841</span>
<span id="842"> 842</span>
<span id="843"> 843</span>
<span id="844"> 844</span>
<span id="845"> 845</span>
<span id="846"> 846</span>
<span id="847"> 847</span>
<span id="848"> 848</span>
<span id="849"> 849</span>
<span id="850"> 850</span>
<span id="851"> 851</span>
<span id="852"> 852</span>
<span id="853"> 853</span>
<span id="854"> 854</span>
<span id="855"> 855</span>
<span id="856"> 856</span>
<span id="857"> 857</span>
<span id="858"> 858</span>
<span id="859"> 859</span>
<span id="860"> 860</span>
<span id="861"> 861</span>
<span id="862"> 862</span>
<span id="863"> 863</span>
<span id="864"> 864</span>
<span id="865"> 865</span>
<span id="866"> 866</span>
<span id="867"> 867</span>
<span id="868"> 868</span>
<span id="869"> 869</span>
<span id="870"> 870</span>
<span id="871"> 871</span>
<span id="872"> 872</span>
<span id="873"> 873</span>
<span id="874"> 874</span>
<span id="875"> 875</span>
<span id="876"> 876</span>
<span id="877"> 877</span>
<span id="878"> 878</span>
<span id="879"> 879</span>
<span id="880"> 880</span>
<span id="881"> 881</span>
<span id="882"> 882</span>
<span id="883"> 883</span>
<span id="884"> 884</span>
<span id="885"> 885</span>
<span id="886"> 886</span>
<span id="887"> 887</span>
<span id="888"> 888</span>
<span id="889"> 889</span>
<span id="890"> 890</span>
<span id="891"> 891</span>
<span id="892"> 892</span>
<span id="893"> 893</span>
<span id="894"> 894</span>
<span id="895"> 895</span>
<span id="896"> 896</span>
<span id="897"> 897</span>
<span id="898"> 898</span>
<span id="899"> 899</span>
<span id="900"> 900</span>
<span id="901"> 901</span>
<span id="902"> 902</span>
<span id="903"> 903</span>
<span id="904"> 904</span>
<span id="905"> 905</span>
<span id="906"> 906</span>
<span id="907"> 907</span>
<span id="908"> 908</span>
<span id="909"> 909</span>
<span id="910"> 910</span>
<span id="911"> 911</span>
<span id="912"> 912</span>
<span id="913"> 913</span>
<span id="914"> 914</span>
<span id="915"> 915</span>
<span id="916"> 916</span>
<span id="917"> 917</span>
<span id="918"> 918</span>
<span id="919"> 919</span>
<span id="920"> 920</span>
<span id="921"> 921</span>
<span id="922"> 922</span>
<span id="923"> 923</span>
<span id="924"> 924</span>
<span id="925"> 925</span>
<span id="926"> 926</span>
<span id="927"> 927</span>
<span id="928"> 928</span>
<span id="929"> 929</span>
<span id="930"> 930</span>
<span id="931"> 931</span>
<span id="932"> 932</span>
<span id="933"> 933</span>
<span id="934"> 934</span>
<span id="935"> 935</span>
<span id="936"> 936</span>
<span id="937"> 937</span>
<span id="938"> 938</span>
<span id="939"> 939</span>
<span id="940"> 940</span>
<span id="941"> 941</span>
<span id="942"> 942</span>
<span id="943"> 943</span>
<span id="944"> 944</span>
<span id="945"> 945</span>
<span id="946"> 946</span>
<span id="947"> 947</span>
<span id="948"> 948</span>
<span id="949"> 949</span>
<span id="950"> 950</span>
<span id="951"> 951</span>
<span id="952"> 952</span>
<span id="953"> 953</span>
<span id="954"> 954</span>
<span id="955"> 955</span>
<span id="956"> 956</span>
<span id="957"> 957</span>
<span id="958"> 958</span>
<span id="959"> 959</span>
<span id="960"> 960</span>
<span id="961"> 961</span>
<span id="962"> 962</span>
<span id="963"> 963</span>
<span id="964"> 964</span>
<span id="965"> 965</span>
<span id="966"> 966</span>
<span id="967"> 967</span>
<span id="968"> 968</span>
<span id="969"> 969</span>
<span id="970"> 970</span>
<span id="971"> 971</span>
<span id="972"> 972</span>
<span id="973"> 973</span>
<span id="974"> 974</span>
<span id="975"> 975</span>
<span id="976"> 976</span>
<span id="977"> 977</span>
<span id="978"> 978</span>
<span id="979"> 979</span>
<span id="980"> 980</span>
<span id="981"> 981</span>
<span id="982"> 982</span>
<span id="983"> 983</span>
<span id="984"> 984</span>
<span id="985"> 985</span>
<span id="986"> 986</span>
<span id="987"> 987</span>
<span id="988"> 988</span>
<span id="989"> 989</span>
<span id="990"> 990</span>
<span id="991"> 991</span>
<span id="992"> 992</span>
<span id="993"> 993</span>
<span id="994"> 994</span>
<span id="995"> 995</span>
<span id="996"> 996</span>
<span id="997"> 997</span>
<span id="998"> 998</span>
<span id="999"> 999</span>
<span id="1000">1000</span>
<span id="1001">1001</span>
<span id="1002">1002</span>
<span id="1003">1003</span>
<span id="1004">1004</span>
<span id="1005">1005</span>
<span id="1006">1006</span>
<span id="1007">1007</span>
<span id="1008">1008</span>
<span id="1009">1009</span>
<span id="1010">1010</span>
<span id="1011">1011</span>
<span id="1012">1012</span>
<span id="1013">1013</span>
<span id="1014">1014</span>
<span id="1015">1015</span>
<span id="1016">1016</span>
<span id="1017">1017</span>
<span id="1018">1018</span>
<span id="1019">1019</span>
<span id="1020">1020</span>
<span id="1021">1021</span>
<span id="1022">1022</span>
<span id="1023">1023</span>
<span id="1024">1024</span>
<span id="1025">1025</span>
<span id="1026">1026</span>
<span id="1027">1027</span>
<span id="1028">1028</span>
<span id="1029">1029</span>
<span id="1030">1030</span>
<span id="1031">1031</span>
<span id="1032">1032</span>
<span id="1033">1033</span>
<span id="1034">1034</span>
<span id="1035">1035</span>
<span id="1036">1036</span>
<span id="1037">1037</span>
<span id="1038">1038</span>
<span id="1039">1039</span>
<span id="1040">1040</span>
<span id="1041">1041</span>
<span id="1042">1042</span>
<span id="1043">1043</span>
<span id="1044">1044</span>
<span id="1045">1045</span>
<span id="1046">1046</span>
<span id="1047">1047</span>
<span id="1048">1048</span>
<span id="1049">1049</span>
<span id="1050">1050</span>
<span id="1051">1051</span>
<span id="1052">1052</span>
<span id="1053">1053</span>
<span id="1054">1054</span>
<span id="1055">1055</span>
<span id="1056">1056</span>
<span id="1057">1057</span>
<span id="1058">1058</span>
<span id="1059">1059</span>
<span id="1060">1060</span>
<span id="1061">1061</span>
<span id="1062">1062</span>
<span id="1063">1063</span>
<span id="1064">1064</span>
<span id="1065">1065</span>
<span id="1066">1066</span>
<span id="1067">1067</span>
<span id="1068">1068</span>
<span id="1069">1069</span>
<span id="1070">1070</span>
<span id="1071">1071</span>
<span id="1072">1072</span>
<span id="1073">1073</span>
<span id="1074">1074</span>
<span id="1075">1075</span>
<span id="1076">1076</span>
<span id="1077">1077</span>
<span id="1078">1078</span>
<span id="1079">1079</span>
<span id="1080">1080</span>
<span id="1081">1081</span>
<span id="1082">1082</span>
<span id="1083">1083</span>
<span id="1084">1084</span>
<span id="1085">1085</span>
<span id="1086">1086</span>
<span id="1087">1087</span>
<span id="1088">1088</span>
<span id="1089">1089</span>
<span id="1090">1090</span>
<span id="1091">1091</span>
<span id="1092">1092</span>
<span id="1093">1093</span>
<span id="1094">1094</span>
<span id="1095">1095</span>
<span id="1096">1096</span>
<span id="1097">1097</span>
<span id="1098">1098</span>
<span id="1099">1099</span>
<span id="1100">1100</span>
<span id="1101">1101</span>
<span id="1102">1102</span>
<span id="1103">1103</span>
<span id="1104">1104</span>
<span id="1105">1105</span>
<span id="1106">1106</span>
<span id="1107">1107</span>
<span id="1108">1108</span>
<span id="1109">1109</span>
<span id="1110">1110</span>
<span id="1111">1111</span>
<span id="1112">1112</span>
<span id="1113">1113</span>
<span id="1114">1114</span>
<span id="1115">1115</span>
<span id="1116">1116</span>
<span id="1117">1117</span>
<span id="1118">1118</span>
<span id="1119">1119</span>
<span id="1120">1120</span>
<span id="1121">1121</span>
<span id="1122">1122</span>
<span id="1123">1123</span>
<span id="1124">1124</span>
<span id="1125">1125</span>
<span id="1126">1126</span>
<span id="1127">1127</span>
<span id="1128">1128</span>
<span id="1129">1129</span>
<span id="1130">1130</span>
<span id="1131">1131</span>
<span id="1132">1132</span>
<span id="1133">1133</span>
<span id="1134">1134</span>
<span id="1135">1135</span>
<span id="1136">1136</span>
<span id="1137">1137</span>
<span id="1138">1138</span>
<span id="1139">1139</span>
<span id="1140">1140</span>
<span id="1141">1141</span>
<span id="1142">1142</span>
<span id="1143">1143</span>
<span id="1144">1144</span>
<span id="1145">1145</span>
<span id="1146">1146</span>
<span id="1147">1147</span>
<span id="1148">1148</span>
<span id="1149">1149</span>
<span id="1150">1150</span>
<span id="1151">1151</span>
<span id="1152">1152</span>
<span id="1153">1153</span>
<span id="1154">1154</span>
<span id="1155">1155</span>
<span id="1156">1156</span>
<span id="1157">1157</span>
<span id="1158">1158</span>
<span id="1159">1159</span>
<span id="1160">1160</span>
<span id="1161">1161</span>
<span id="1162">1162</span>
<span id="1163">1163</span>
<span id="1164">1164</span>
<span id="1165">1165</span>
<span id="1166">1166</span>
<span id="1167">1167</span>
<span id="1168">1168</span>
<span id="1169">1169</span>
<span id="1170">1170</span>
<span id="1171">1171</span>
<span id="1172">1172</span>
<span id="1173">1173</span>
<span id="1174">1174</span>
<span id="1175">1175</span>
<span id="1176">1176</span>
<span id="1177">1177</span>
<span id="1178">1178</span>
<span id="1179">1179</span>
<span id="1180">1180</span>
<span id="1181">1181</span>
<span id="1182">1182</span>
<span id="1183">1183</span>
<span id="1184">1184</span>
<span id="1185">1185</span>
<span id="1186">1186</span>
<span id="1187">1187</span>
<span id="1188">1188</span>
<span id="1189">1189</span>
<span id="1190">1190</span>
<span id="1191">1191</span>
<span id="1192">1192</span>
<span id="1193">1193</span>
<span id="1194">1194</span>
<span id="1195">1195</span>
<span id="1196">1196</span>
<span id="1197">1197</span>
<span id="1198">1198</span>
<span id="1199">1199</span>
<span id="1200">1200</span>
<span id="1201">1201</span>
<span id="1202">1202</span>
<span id="1203">1203</span>
<span id="1204">1204</span>
<span id="1205">1205</span>
<span id="1206">1206</span>
<span id="1207">1207</span>
<span id="1208">1208</span>
<span id="1209">1209</span>
<span id="1210">1210</span>
<span id="1211">1211</span>
<span id="1212">1212</span>
<span id="1213">1213</span>
<span id="1214">1214</span>
<span id="1215">1215</span>
<span id="1216">1216</span>
<span id="1217">1217</span>
<span id="1218">1218</span>
<span id="1219">1219</span>
<span id="1220">1220</span>
<span id="1221">1221</span>
<span id="1222">1222</span>
<span id="1223">1223</span>
<span id="1224">1224</span>
<span id="1225">1225</span>
<span id="1226">1226</span>
<span id="1227">1227</span>
<span id="1228">1228</span>
<span id="1229">1229</span>
<span id="1230">1230</span>
<span id="1231">1231</span>
<span id="1232">1232</span>
<span id="1233">1233</span>
<span id="1234">1234</span>
<span id="1235">1235</span>
<span id="1236">1236</span>
<span id="1237">1237</span>
<span id="1238">1238</span>
<span id="1239">1239</span>
</pre><pre class='rust '>
<span class='doccomment'>/*!
Easy-to-use, high-level, OpenGL3+ wrapper.

# Initialization

This library defines the `DisplayBuild` trait which is curently implemented only on
`glutin::WindowBuilder`.

Initialization is done by creating a `WindowBuilder` and calling `build_glium`.

```no_run
extern crate glutin;
extern crate glium;

fn main() {
    use glium::DisplayBuild;

    let display = glutin::WindowBuilder::new()
        .with_dimensions(1024, 768)
        .with_title(format!(&quot;Hello world&quot;))
        .build_glium().unwrap();
}
```

The `display` object is the most important object of this library.

The window you are drawing on will produce events. They can be received by calling
`display.poll_events()`.

# Complete example

The first step is to create the vertex buffer, which contains the list of all the points that
make up our mesh. The elements that we pass to `VertexBuffer::new` must implement the
`glium::vertex::VertexFormat` trait, which can be easily added for any custom struct thanks to the
`implement_vertex!` macro.

See the `vertex` module documentation for more informations.

```no_run
# #[macro_use]
# extern crate glium;
# fn main() {
#[derive(Copy)]
struct Vertex {
    position: [f32; 2],
    color: [f32; 3],
}

implement_vertex!(Vertex, position, color);

# let display: glium::Display = unsafe { std::mem::uninitialized() };
let vertex = glium::VertexBuffer::new(&amp;display, vec![
    Vertex { position: [-0.5, -0.5], color: [0.0, 1.0, 0.0] },
    Vertex { position: [ 0.0,  0.5], color: [0.0, 0.0, 1.0] },
    Vertex { position: [ 0.5, -0.5], color: [1.0, 0.0, 0.0] },
]);
# }
```

We will also need to tell glium how the vertices must be linked together. We could create an index
buffer, but since we only have a single triangle the simpler solution here is not to use indices.

```no_run
use glium::index;
let indices = index::NoIndices(index::PrimitiveType::TrianglesList);
```

Next, we create the program, which is composed of a *vertex shader*, a program executed once for
each element in our vertex buffer, and a *fragment shader*, a program executed once for each
pixel before it is written on the final image.

The purpose of a program is to instruct the GPU how to process our mesh, in order to obtain pixels.

```no_run
# let display: glium::Display = unsafe { std::mem::uninitialized() };
let program = glium::Program::from_source(&amp;display,
    // vertex shader
    &quot;   #version 110

        uniform mat4 matrix;

        attribute vec2 position;
        attribute vec3 color;

        varying vec3 v_color;

        void main() {
            gl_Position = vec4(position, 0.0, 1.0) * matrix;
            v_color = color;
        }
    &quot;,

    // fragment shader
    &quot;   #version 110
        varying vec3 v_color;

        void main() {
            gl_FragColor = vec4(v_color, 1.0);
        }
    &quot;,

    // optional geometry shader
    None
).unwrap();
```

*Note: teaching you the GLSL language is not covered by this guide.*

You may notice that the `attribute` declarations in the vertex shader match the field names and
types of the elements in the vertex buffer. This is required, otherwise drawing will result in
an error.

In the example above, one of our shaders contains `uniform mat4 matrix;`. Uniforms are global
variables in our program whose values are chosen by the application.

```no_run
# #[macro_use]
# extern crate glium;
# fn main() {
let uniforms = uniform! {
    matrix: [
        [ 1.0, 0.0, 0.0, 0.0 ],
        [ 0.0, 1.0, 0.0, 0.0 ],
        [ 0.0, 0.0, 1.0, 0.0 ],
        [ 0.0, 0.0, 0.0, 1.0 ]
    ]
};
# }
```

The value of uniforms can be of any type that implements `glium::uniforms::UniformValue`.
This includes textures and samplers (not covered here). See the `uniforms` module documentation 
for more informations.

Now that everything is initialized, we can finally draw something. The `display.draw()` function
will start drawing a new frame and return a `Frame` object. This `Frame` object has a `draw`
function, which you can use to draw things.

Its arguments are the source of vertices, source of indices, program, uniforms, and an object of
type `DrawParameters` which  contains miscellaneous information specifying how everything should
be rendered (depth test, blending, backface culling, etc.).

```no_run
use glium::Surface;
# let display: glium::Display = unsafe { std::mem::uninitialized() };
# let vertex_buffer: glium::VertexBuffer&lt;u8&gt; = unsafe { std::mem::uninitialized() };
# let indices: glium::IndexBuffer = unsafe { std::mem::uninitialized() };
# let program: glium::Program = unsafe { std::mem::uninitialized() };
# let uniforms = glium::uniforms::EmptyUniforms;
let mut target = display.draw();
target.clear_color(0.0, 0.0, 0.0, 0.0);  // filling the output with the black color
target.draw(&amp;vertex_buffer, &amp;indices, &amp;program, &amp;uniforms,
            &amp;std::default::Default::default()).unwrap();
target.finish();
```

*/</span>
<span class='attribute'>#<span class='op'>!</span>[<span class='ident'>feature</span>(<span class='ident'>core</span>, <span class='ident'>hash</span>, <span class='ident'>std_misc</span>, <span class='ident'>collections</span>)]</span>     <span class='comment'>// TODO: remove after 1.0 beta</span>

<span class='attribute'>#<span class='op'>!</span>[<span class='ident'>feature</span>(<span class='ident'>unboxed_closures</span>)]</span>
<span class='attribute'>#<span class='op'>!</span>[<span class='ident'>feature</span>(<span class='ident'>unsafe_destructor</span>)]</span>
<span class='attribute'>#<span class='op'>!</span>[<span class='ident'>unstable</span>]</span>
<span class='attribute'>#<span class='op'>!</span>[<span class='ident'>warn</span>(<span class='ident'>missing_docs</span>)]</span>

<span class='comment'>// TODO: remove these when everything is implemented</span>
<span class='attribute'>#<span class='op'>!</span>[<span class='ident'>allow</span>(<span class='ident'>dead_code</span>)]</span>
<span class='attribute'>#<span class='op'>!</span>[<span class='ident'>allow</span>(<span class='ident'>unused_variables</span>)]</span>

<span class='attribute'>#[<span class='ident'>cfg</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;cgmath&quot;</span>)]</span>
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>cgmath</span>;
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>glutin</span>;
<span class='attribute'>#[<span class='ident'>cfg</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;image&quot;</span>)]</span>
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>image</span>;
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>libc</span>;
<span class='attribute'>#[<span class='ident'>cfg</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;nalgebra&quot;</span>)]</span>
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>nalgebra</span>;

<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>context</span>::{<span class='ident'>PollEventsIter</span>, <span class='ident'>WaitEventsIter</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>draw_parameters</span>::{<span class='ident'>BlendingFunction</span>, <span class='ident'>LinearBlendingFactor</span>, <span class='ident'>BackfaceCullingMode</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>draw_parameters</span>::{<span class='ident'>DepthTest</span>, <span class='ident'>PolygonMode</span>, <span class='ident'>DrawParameters</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>index</span>::<span class='ident'>IndexBuffer</span>;
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>vertex</span>::{<span class='ident'>VertexBuffer</span>, <span class='ident'>Vertex</span>, <span class='ident'>VertexFormat</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>program</span>::{<span class='ident'>Program</span>, <span class='ident'>ProgramCreationError</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>program</span>::<span class='ident'>ProgramCreationError</span>::{<span class='ident'>CompilationError</span>, <span class='ident'>LinkingError</span>, <span class='ident'>ShaderTypeNotSupported</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>sync</span>::{<span class='ident'>LinearSyncFence</span>, <span class='ident'>SyncFence</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>texture</span>::{<span class='ident'>Texture</span>, <span class='ident'>Texture2d</span>};
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>version</span>::{<span class='ident'>Api</span>, <span class='ident'>Version</span>};

<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>default</span>::<span class='ident'>Default</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>collections</span>::<span class='ident'>hash_state</span>::<span class='ident'>DefaultState</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>collections</span>::<span class='ident'>HashMap</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>ops</span>::<span class='ident'>Deref</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>sync</span>::{<span class='ident'>Arc</span>, <span class='ident'>Mutex</span>, <span class='ident'>RwLockReadGuard</span>};
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>sync</span>::<span class='ident'>mpsc</span>::<span class='ident'>channel</span>;

<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>debug</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>framebuffer</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>index</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>pixel_buffer</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>macros</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>program</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>render_buffer</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>uniforms</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>vertex</span>;
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>texture</span>;

<span class='attribute'>#[<span class='ident'>deprecated</span> <span class='op'>=</span> <span class='string'>&quot;`index_buffer` has been renamed to `index`&quot;</span>]</span>
<span class='attribute'>#[<span class='ident'>allow</span>(<span class='ident'>missing_docs</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>index_buffer</span> {
    <span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>index</span>::<span class='op'>*</span>;
}

<span class='kw'>mod</span> <span class='ident'>buffer</span>;
<span class='kw'>mod</span> <span class='ident'>context</span>;
<span class='kw'>mod</span> <span class='ident'>draw_parameters</span>;
<span class='kw'>mod</span> <span class='ident'>fbo</span>;
<span class='kw'>mod</span> <span class='ident'>ops</span>;
<span class='kw'>mod</span> <span class='ident'>sampler_object</span>;
<span class='kw'>mod</span> <span class='ident'>sync</span>;
<span class='kw'>mod</span> <span class='ident'>util</span>;
<span class='kw'>mod</span> <span class='ident'>version</span>;
<span class='kw'>mod</span> <span class='ident'>vertex_array_object</span>;

<span class='kw'>mod</span> <span class='ident'>gl</span> {
    <span class='macro'>include</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='macro'>env</span><span class='macro'>!</span>(<span class='string'>&quot;OUT_DIR&quot;</span>), <span class='string'>&quot;/gl_bindings.rs&quot;</span>));
}

<span class='doccomment'>/// Trait for objects that are OpenGL objects.</span>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>GlObject</span> {
    <span class='kw'>type</span> <span class='ident'>Id</span>;

    <span class='doccomment'>/// Returns the id of the object.</span>
    <span class='kw'>fn</span> <span class='ident'>get_id</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Self</span>::<span class='ident'>Id</span>;
}

<span class='doccomment'>/// Handle to a shader or a program.</span>
<span class='comment'>// TODO: Handle(null()) is equal to Id(0)</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>PartialEq</span>, <span class='ident'>Eq</span>, <span class='ident'>Copy</span>, <span class='ident'>Clone</span>, <span class='ident'>Debug</span>, <span class='ident'>Hash</span>)]</span>
<span class='kw'>enum</span> <span class='ident'>Handle</span> {
    <span class='ident'>Id</span>(<span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLuint</span>),
    <span class='ident'>Handle</span>(<span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLhandleARB</span>),
}

<span class='kw'>unsafe</span> <span class='kw'>impl</span> <span class='ident'>Send</span> <span class='kw'>for</span> <span class='ident'>Handle</span> {}

<span class='doccomment'>/// Internal trait for enums that can be turned into GLenum.</span>
<span class='kw'>trait</span> <span class='ident'>ToGlEnum</span> {
    <span class='doccomment'>/// Returns the value.</span>
    <span class='kw'>fn</span> <span class='ident'>to_glenum</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLenum</span>;
}

<span class='doccomment'>/// Area of a surface in pixels.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// In the OpenGL ecosystem, the (0,0) coordinate is at the bottom-left hand corner of the images.</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Debug</span>, <span class='ident'>Clone</span>, <span class='ident'>Copy</span>, <span class='ident'>Default</span>, <span class='ident'>PartialEq</span>, <span class='ident'>Eq</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Rect</span> {
    <span class='doccomment'>/// Number of pixels between the left border of the surface and the left border of</span>
    <span class='doccomment'>/// the rectangle.</span>
    <span class='kw'>pub</span> <span class='ident'>left</span>: <span class='ident'>u32</span>,
    <span class='doccomment'>/// Number of pixels between the bottom border of the surface and the bottom border</span>
    <span class='doccomment'>/// of the rectangle.</span>
    <span class='kw'>pub</span> <span class='ident'>bottom</span>: <span class='ident'>u32</span>,
    <span class='doccomment'>/// Width of the area in pixels.</span>
    <span class='kw'>pub</span> <span class='ident'>width</span>: <span class='ident'>u32</span>,
    <span class='doccomment'>/// Height of the area in pixels.</span>
    <span class='kw'>pub</span> <span class='ident'>height</span>: <span class='ident'>u32</span>,
}

<span class='doccomment'>/// Area of a surface in pixels. Similar to a `Rect` except that dimensions can be negative.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// In the OpenGL ecosystem, the (0,0) coordinate is at the bottom-left hand corner of the images.</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Debug</span>, <span class='ident'>Clone</span>, <span class='ident'>Copy</span>, <span class='ident'>Default</span>, <span class='ident'>PartialEq</span>, <span class='ident'>Eq</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>BlitTarget</span> {
    <span class='doccomment'>/// Number of pixels between the left border of the surface and the left border of</span>
    <span class='doccomment'>/// the rectangle.</span>
    <span class='kw'>pub</span> <span class='ident'>left</span>: <span class='ident'>u32</span>,
    <span class='doccomment'>/// Number of pixels between the bottom border of the surface and the bottom border</span>
    <span class='doccomment'>/// of the rectangle.</span>
    <span class='kw'>pub</span> <span class='ident'>bottom</span>: <span class='ident'>u32</span>,
    <span class='doccomment'>/// Width of the area in pixels. Can be negative.</span>
    <span class='kw'>pub</span> <span class='ident'>width</span>: <span class='ident'>i32</span>,
    <span class='doccomment'>/// Height of the area in pixels. Can be negative.</span>
    <span class='kw'>pub</span> <span class='ident'>height</span>: <span class='ident'>i32</span>,
}

<span class='doccomment'>/// Object that can be drawn upon.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// # What does the GPU do when you draw?</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This is a summary of everything that happens when you call the `draw` function. Note that</span>
<span class='doccomment'>/// this is not necessarly *exactly* what happens. Backends are free to do whatever they want</span>
<span class='doccomment'>/// as long as it always matches the expected outcome.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 1: Vertex shader</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// For each vertex in the vertices source, the GPU invokes the vertex shader that is part</span>
<span class='doccomment'>/// of the program, and passes the corresponding vertex&#39;s attributes to it.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The vertex shader *must* write the special `gl_Position` variable in order to indicate</span>
<span class='doccomment'>/// the four-dimensions coordinates of the vertex. In order to understand what these coordinates</span>
<span class='doccomment'>/// mean, see the &quot;vertex post-processing&quot; step below.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// In addition to the position of the vertex, the vertex shader can also specify the values of</span>
<span class='doccomment'>/// various vertex attributes.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 2: Tessellation (optional)</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// It is possible to use tessellation shaders, but glium does not support them yet.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 3: Geometry shader (optional)</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// If you specify a geometry shader, then the GPU will invoke it once for each primitive.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The geometry shader can output multiple primitives.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 4: Transform feedback (optional)</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Transform feedback is not supported by glium for the moment.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 5: Vertex post-processing</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The vertex shader step told the GPU what the coordinates of each vertex are, but these</span>
<span class='doccomment'>/// coordinates have four dimensions, named `x`, `y`, `z` and `w`.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The GPU then computes the position of the vertex on the 2D surface you are drawing on, and</span>
<span class='doccomment'>/// the depth of this vertex:</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ```notrust</span>
<span class='doccomment'>/// window_x = viewport_left + viewport_width * ((x / w) + 1.0) / 2.0</span>
<span class='doccomment'>/// window_y = viewport_bottom + viewport_height * ((y / w) + 1.0) / 2.0</span>
<span class='doccomment'>/// depth = depth_near + (depth_far - depth_near) * ((z / w) + 1.0) / 2.0</span>
<span class='doccomment'>/// ```</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// *`viewport_left`, `viewport_width`, `viewport_bottom` and `viewport_height` correspond to</span>
<span class='doccomment'>/// the `viewport` member of the draw parameters, and `depth_near` and `depth_far` correspond</span>
<span class='doccomment'>/// to the `depth_range` member*.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This means that if `x / w`, `y / w` or `z / w` are equal to `-1.0`, then the result will be</span>
<span class='doccomment'>/// `viewport_left`, `viewport_bottom` or `depth_near`. If they are equal to `1.0`, the result</span>
<span class='doccomment'>/// will be `viewport_left + viewport_width` (the right of the viewport),</span>
<span class='doccomment'>/// `viewport_bottom + viewport_height` (the top of the viewport) or `depth_far`.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// For example if you want to draw a rectangle that covers the whole screen, it should be made</span>
<span class='doccomment'>/// of four vertices whose coordinates are `(-1.0, -1.0, 0.0, 1.0)` (bottom-left corner),</span>
<span class='doccomment'>/// `(-1.0, 1.0, 0.0, 1.0)` (top-left corner), `(1.0, 1.0, 0.0, 1.0)` (top-right corner) and</span>
<span class='doccomment'>/// `(1.0, -1.0, 0.0, 1.0)` (bottom-right corner).</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 6: Primitive assembly</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The next step consists in building the primitives. Triangle strips, triangle fans and line</span>
<span class='doccomment'>/// strips are turned into individual triangles or lines.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Triangle strips obey certain rules for the order of indices. For example the triangle strip</span>
<span class='doccomment'>/// `0, 1, 2, 3, 4, 5` does *not* correspond to `0, 1, 2`, `1, 2, 3`, `2, 3, 4`, `3, 4, 5` as you</span>
<span class='doccomment'>/// would expect, but to `0, 1, 2`, `1, 3, 2`, `2, 3, 4`, `3, 5, 4` (some indices are reversed).</span>
<span class='doccomment'>/// This is important with regards to the face culling step below.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Then, if you did specify `PrimitiveMode`, it is used. If you specified `Line`, triangles are</span>
<span class='doccomment'>/// turned into lines. If specified `Point`, triangles and lines are turned into points.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The GPU then looks at the screen coordinates of each primitive, and discards primitives that</span>
<span class='doccomment'>/// are entirely outside of the window.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Note that points whose centers are outside of the viewport are discarded, even if the point</span>
<span class='doccomment'>/// width would be big enough for the point to be visible. However this standard behavior is not</span>
<span class='doccomment'>/// respected by nVidia drivers, which show the points anyway.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 7: Face culling (triangles only)</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This step is purely an optimization step and only concerns triangles.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// If you specify a value for `backface_culling` other than `CullingDisabled`, the GPU will</span>
<span class='doccomment'>/// discard triangles depending on the way that the vertices are arranged on the window. You can</span>
<span class='doccomment'>/// either discard triangles whose vertices are clockwise or counterclockwise.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// For more information, see the `BackfaceCullingMode` documentation.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 8: Rasterization</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Now that the GPU knows where on the window the various triangles, points or lines are, it will</span>
<span class='doccomment'>/// determine which pixels of the surface are part of each primitive.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// For points and lines, this step depends on the points width and line width that you specified</span>
<span class='doccomment'>/// in the draw parameters.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// &lt;img alt=&quot;&quot; src=&quot;data:image/png;base64,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&quot; /&gt;</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The attributes of each vertex are being interpolated, and the GPU assigns a value for each</span>
<span class='doccomment'>/// attribute for each pixel.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 9: Fragment shader</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The GPU now executes the fragment shader once for each pixel of each primitive.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The vertex attributes that were interpolated at the previous step are passed to the fragment</span>
<span class='doccomment'>/// shader.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The fragment shader must return the color to write by setting the value of `gl_FragColor`.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 10: Pixel ownership</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This step is mostly an implementation detail. If the window you are drawing on is not on the</span>
<span class='doccomment'>/// foreground, or if it is partially obstructed, then the pixels that are not on the</span>
<span class='doccomment'>/// foreground will be discarded.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This is only relevant if you draw to the default framebuffer.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 11: Scissor test</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// If `scissor` has been specified, then all the pixels that are outside of this rect</span>
<span class='doccomment'>/// are discarded.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 12: Multisampling</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 13: Stencil test</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Stencil tests are currently not supported by glium.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 14: Depth test</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// In addition to the colors, surfaces can also have a depth buffer attached to it. In this</span>
<span class='doccomment'>/// situation, just like each pixel has a color, each pixel of the surface also has an associated</span>
<span class='doccomment'>/// depth value.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// If a depth buffer is present, the GPU will compare the depth value of the pixel currently</span>
<span class='doccomment'>/// being processed, with the existing depth value. Depending on the value of `depth_test`</span>
<span class='doccomment'>/// in the draw parameters, the depth test will either pass, in which case the pipeline</span>
<span class='doccomment'>/// continues, or fail, in which case the pixel is discarded. If the value of `depth_write`</span>
<span class='doccomment'>/// is true and the test passed, it will then also write the depth value of the pixel on the</span>
<span class='doccomment'>/// depth buffer.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The purpose of this test is to avoid drawing elements that are in the background of the</span>
<span class='doccomment'>/// scene over elements that are in the foreground.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// See the documentation of `DepthTest` for more informations.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 15: Blending</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// For each pixel to write, the GPU takes the RGBA color that the fragment shader has returned</span>
<span class='doccomment'>/// and the existing RGBA color already written on the surface, and merges the two.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The way they are merged depends on the value of `blending_function`. This allows you to choose</span>
<span class='doccomment'>/// how alpha colors are merged together.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// See the documentation of `BlendingFunction` fore more informations.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 16: Dithering (optional)</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Step 17: End</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This is finally the step where colors are being written.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// ## Missing steps</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Some steps are missing because they are not supported by glium for the moment: dithering,</span>
<span class='doccomment'>/// occlusion query updating, logic operations, sRGB conversion, write masks.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Instancing and multiple viewports are also missing, as they are not supported.</span>
<span class='doccomment'>///</span>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>Surface</span>: <span class='ident'>Sized</span> {
    <span class='doccomment'>/// Clears some attachments of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>color</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span>(<span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>)<span class='op'>&gt;</span>, <span class='ident'>depth</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>f32</span><span class='op'>&gt;</span>,
             <span class='ident'>stencil</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>i32</span><span class='op'>&gt;</span>);

    <span class='doccomment'>/// Clears the color attachment of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear_color</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>red</span>: <span class='ident'>f32</span>, <span class='ident'>green</span>: <span class='ident'>f32</span>, <span class='ident'>blue</span>: <span class='ident'>f32</span>, <span class='ident'>alpha</span>: <span class='ident'>f32</span>) {
        <span class='self'>self</span>.<span class='ident'>clear</span>(<span class='prelude-val'>Some</span>((<span class='ident'>red</span>, <span class='ident'>green</span>, <span class='ident'>blue</span>, <span class='ident'>alpha</span>)), <span class='prelude-val'>None</span>, <span class='prelude-val'>None</span>);
    }

    <span class='doccomment'>/// Clears the depth attachment of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear_depth</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>value</span>: <span class='ident'>f32</span>) {
        <span class='self'>self</span>.<span class='ident'>clear</span>(<span class='prelude-val'>None</span>, <span class='prelude-val'>Some</span>(<span class='ident'>value</span>), <span class='prelude-val'>None</span>);
    }

    <span class='doccomment'>/// Clears the stencil attachment of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear_stencil</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>value</span>: <span class='ident'>i32</span>) {
        <span class='self'>self</span>.<span class='ident'>clear</span>(<span class='prelude-val'>None</span>, <span class='prelude-val'>None</span>, <span class='prelude-val'>Some</span>(<span class='ident'>value</span>));
    }

    <span class='doccomment'>/// Clears the color and depth attachments of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear_color_and_depth</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>color</span>: (<span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>), <span class='ident'>depth</span>: <span class='ident'>f32</span>) {
        <span class='self'>self</span>.<span class='ident'>clear</span>(<span class='prelude-val'>Some</span>(<span class='ident'>color</span>), <span class='prelude-val'>Some</span>(<span class='ident'>depth</span>), <span class='prelude-val'>None</span>);
    }

    <span class='doccomment'>/// Clears the color and stencil attachments of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear_color_and_stencil</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>color</span>: (<span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>), <span class='ident'>stencil</span>: <span class='ident'>i32</span>) {
        <span class='self'>self</span>.<span class='ident'>clear</span>(<span class='prelude-val'>Some</span>(<span class='ident'>color</span>), <span class='prelude-val'>None</span>, <span class='prelude-val'>Some</span>(<span class='ident'>stencil</span>));
    }

    <span class='doccomment'>/// Clears the depth and stencil attachments of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear_depth_and_stencil</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>depth</span>: <span class='ident'>f32</span>, <span class='ident'>stencil</span>: <span class='ident'>i32</span>) {
        <span class='self'>self</span>.<span class='ident'>clear</span>(<span class='prelude-val'>None</span>, <span class='prelude-val'>Some</span>(<span class='ident'>depth</span>), <span class='prelude-val'>Some</span>(<span class='ident'>stencil</span>));
    }

    <span class='doccomment'>/// Clears the color, depth and stencil attachments of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>clear_all</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>color</span>: (<span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>), <span class='ident'>depth</span>: <span class='ident'>f32</span>, <span class='ident'>stencil</span>: <span class='ident'>i32</span>) {
        <span class='self'>self</span>.<span class='ident'>clear</span>(<span class='prelude-val'>Some</span>(<span class='ident'>color</span>), <span class='prelude-val'>Some</span>(<span class='ident'>depth</span>), <span class='prelude-val'>Some</span>(<span class='ident'>stencil</span>));
    }

    <span class='doccomment'>/// Returns the dimensions in pixels of the target.</span>
    <span class='kw'>fn</span> <span class='ident'>get_dimensions</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>u32</span>, <span class='ident'>u32</span>);

    <span class='doccomment'>/// Returns the number of bits of each pixel of the depth buffer.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if there is no depth buffer.</span>
    <span class='kw'>fn</span> <span class='ident'>get_depth_buffer_bits</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>u16</span><span class='op'>&gt;</span>;

    <span class='doccomment'>/// Returns true if the surface has a depth buffer available.</span>
    <span class='kw'>fn</span> <span class='ident'>has_depth_buffer</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> {
        <span class='self'>self</span>.<span class='ident'>get_depth_buffer_bits</span>().<span class='ident'>is_some</span>()
    }

    <span class='doccomment'>/// Returns the number of bits of each pixel of the stencil buffer.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if there is no stencil buffer.</span>
    <span class='kw'>fn</span> <span class='ident'>get_stencil_buffer_bits</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>u16</span><span class='op'>&gt;</span>;

    <span class='doccomment'>/// Returns true if the surface has a stencil buffer available.</span>
    <span class='kw'>fn</span> <span class='ident'>has_stencil_buffer</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>bool</span> {
        <span class='self'>self</span>.<span class='ident'>get_stencil_buffer_bits</span>().<span class='ident'>is_some</span>()
    }

    <span class='doccomment'>/// Draws.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// See above for what happens exactly when you draw.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// # Panic</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// - Panics if the requested depth function requires a depth buffer and none is attached.</span>
    <span class='doccomment'>/// - Panics if the type of some of the vertex source&#39;s attributes do not match the program&#39;s.</span>
    <span class='doccomment'>/// - Panics if a program&#39;s attribute is not in the vertex source (does *not* panic if a</span>
    <span class='doccomment'>///   vertex&#39;s attribute is not used by the program).</span>
    <span class='doccomment'>/// - Panics if the viewport is larger than the dimensions supported by the hardware.</span>
    <span class='doccomment'>/// - Panics if the depth range is outside of `(0, 1)`.</span>
    <span class='doccomment'>/// - Panics if a value in the uniforms doesn&#39;t match the type requested by the program.</span>
    <span class='doccomment'>///</span>
    <span class='kw'>fn</span> <span class='ident'>draw</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span>, <span class='lifetime'>&#39;b</span>, <span class='ident'>V</span>, <span class='ident'>I</span>, <span class='ident'>U</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>V</span>, <span class='kw-2'>&amp;</span><span class='ident'>I</span>, <span class='ident'>program</span>: <span class='kw-2'>&amp;</span><span class='ident'>Program</span>, <span class='ident'>uniforms</span>: <span class='ident'>U</span>,
        <span class='ident'>draw_parameters</span>: <span class='kw-2'>&amp;</span><span class='ident'>DrawParameters</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span>(), <span class='ident'>DrawError</span><span class='op'>&gt;</span> <span class='kw'>where</span>
        <span class='ident'>V</span>: <span class='ident'>vertex</span>::<span class='ident'>MultiVerticesSource</span><span class='op'>&lt;</span><span class='lifetime'>&#39;b</span><span class='op'>&gt;</span>, <span class='ident'>I</span>: <span class='ident'>index</span>::<span class='ident'>ToIndicesSource</span>,
        <span class='ident'>U</span>: <span class='ident'>uniforms</span>::<span class='ident'>Uniforms</span>;

    <span class='doccomment'>/// Returns an opaque type that is used by the implementation of blit functions.</span>
    <span class='kw'>fn</span> <span class='ident'>get_blit_helper</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>BlitHelper</span>;

    <span class='doccomment'>/// Copies a rectangle of pixels from this surface to another surface.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// The `source_rect` defines the area of the source (`self`) that will be copied, and the</span>
    <span class='doccomment'>/// `target_rect` defines the area where the copied image will be pasted. If the source and</span>
    <span class='doccomment'>/// target areas don&#39;t have the same dimensions, the image will be resized to match.</span>
    <span class='doccomment'>/// The `filter` parameter is relevant only in this situation.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// It is possible for the source and the target to be the same surface. However if the</span>
    <span class='doccomment'>/// rectangles overlap, then the behavior is undefined.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Note that there is no alpha blending, depth/stencil checking, etc. This function just</span>
    <span class='doccomment'>/// copies pixels.</span>
    <span class='attribute'>#[<span class='ident'>unstable</span> <span class='op'>=</span> <span class='string'>&quot;The name will likely change&quot;</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>blit_color</span><span class='op'>&lt;</span><span class='ident'>S</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>source_rect</span>: <span class='kw-2'>&amp;</span><span class='ident'>Rect</span>, <span class='ident'>target</span>: <span class='kw-2'>&amp;</span><span class='ident'>S</span>, <span class='ident'>target_rect</span>: <span class='kw-2'>&amp;</span><span class='ident'>BlitTarget</span>,
        <span class='ident'>filter</span>: <span class='ident'>uniforms</span>::<span class='ident'>MagnifySamplerFilter</span>) <span class='kw'>where</span> <span class='ident'>S</span>: <span class='ident'>Surface</span>
    {
        <span class='ident'>ops</span>::<span class='ident'>blit</span>(<span class='self'>self</span>, <span class='ident'>target</span>, <span class='ident'>gl</span>::<span class='ident'>COLOR_BUFFER_BIT</span>, <span class='ident'>source_rect</span>, <span class='ident'>target_rect</span>,
            <span class='ident'>filter</span>.<span class='ident'>to_glenum</span>())
    }

    <span class='doccomment'>/// Copies the entire surface to a target surface. See `blit_color`.</span>
    <span class='attribute'>#[<span class='ident'>unstable</span> <span class='op'>=</span> <span class='string'>&quot;The name will likely change&quot;</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>blit_whole_color_to</span><span class='op'>&lt;</span><span class='ident'>S</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>target</span>: <span class='kw-2'>&amp;</span><span class='ident'>S</span>, <span class='ident'>target_rect</span>: <span class='kw-2'>&amp;</span><span class='ident'>BlitTarget</span>,
        <span class='ident'>filter</span>: <span class='ident'>uniforms</span>::<span class='ident'>MagnifySamplerFilter</span>) <span class='kw'>where</span> <span class='ident'>S</span>: <span class='ident'>Surface</span>
    {
        <span class='kw'>let</span> <span class='ident'>src_dim</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>get_dimensions</span>();
        <span class='kw'>let</span> <span class='ident'>src_rect</span> <span class='op'>=</span> <span class='ident'>Rect</span> { <span class='ident'>left</span>: <span class='number'>0</span>, <span class='ident'>bottom</span>: <span class='number'>0</span>, <span class='ident'>width</span>: <span class='ident'>src_dim</span>.<span class='number'>0</span> <span class='kw'>as</span> <span class='ident'>u32</span>, <span class='ident'>height</span>: <span class='ident'>src_dim</span>.<span class='number'>1</span> <span class='kw'>as</span> <span class='ident'>u32</span> };
        <span class='self'>self</span>.<span class='ident'>blit_color</span>(<span class='kw-2'>&amp;</span><span class='ident'>src_rect</span>, <span class='ident'>target</span>, <span class='ident'>target_rect</span>, <span class='ident'>filter</span>)
    }

    <span class='doccomment'>/// Copies the entire surface to the entire target. See `blit_color`.</span>
    <span class='attribute'>#[<span class='ident'>unstable</span> <span class='op'>=</span> <span class='string'>&quot;The name will likely change&quot;</span>]</span>
    <span class='kw'>fn</span> <span class='ident'>fill</span><span class='op'>&lt;</span><span class='ident'>S</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>target</span>: <span class='kw-2'>&amp;</span><span class='ident'>S</span>, <span class='ident'>filter</span>: <span class='ident'>uniforms</span>::<span class='ident'>MagnifySamplerFilter</span>) <span class='kw'>where</span> <span class='ident'>S</span>: <span class='ident'>Surface</span> {
        <span class='kw'>let</span> <span class='ident'>src_dim</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>get_dimensions</span>();
        <span class='kw'>let</span> <span class='ident'>src_rect</span> <span class='op'>=</span> <span class='ident'>Rect</span> { <span class='ident'>left</span>: <span class='number'>0</span>, <span class='ident'>bottom</span>: <span class='number'>0</span>, <span class='ident'>width</span>: <span class='ident'>src_dim</span>.<span class='number'>0</span> <span class='kw'>as</span> <span class='ident'>u32</span>, <span class='ident'>height</span>: <span class='ident'>src_dim</span>.<span class='number'>1</span> <span class='kw'>as</span> <span class='ident'>u32</span> };
        <span class='kw'>let</span> <span class='ident'>target_dim</span> <span class='op'>=</span> <span class='ident'>target</span>.<span class='ident'>get_dimensions</span>();
        <span class='kw'>let</span> <span class='ident'>target_rect</span> <span class='op'>=</span> <span class='ident'>BlitTarget</span> { <span class='ident'>left</span>: <span class='number'>0</span>, <span class='ident'>bottom</span>: <span class='number'>0</span>, <span class='ident'>width</span>: <span class='ident'>target_dim</span>.<span class='number'>0</span> <span class='kw'>as</span> <span class='ident'>i32</span>, <span class='ident'>height</span>: <span class='ident'>target_dim</span>.<span class='number'>1</span> <span class='kw'>as</span> <span class='ident'>i32</span> };
        <span class='self'>self</span>.<span class='ident'>blit_color</span>(<span class='kw-2'>&amp;</span><span class='ident'>src_rect</span>, <span class='ident'>target</span>, <span class='kw-2'>&amp;</span><span class='ident'>target_rect</span>, <span class='ident'>filter</span>)
    }
}

<span class='doccomment'>/// Error that can happen while drawing.</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>, <span class='ident'>Debug</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>enum</span> <span class='ident'>DrawError</span> {
    <span class='doccomment'>/// A depth function has been requested but no depth buffer is available.</span>
    <span class='ident'>NoDepthBuffer</span>,

    <span class='doccomment'>/// The type of a vertex attribute in the vertices source doesn&#39;t match what the</span>
    <span class='doccomment'>/// program requires.</span>
    <span class='ident'>AttributeTypeMismatch</span>,

    <span class='doccomment'>/// One of the attributes required by the program is missing from the vertex format.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Note that it is perfectly valid to have an attribute in the vertex format that is</span>
    <span class='doccomment'>/// not used by the program.</span>
    <span class='ident'>AttributeMissing</span>,

    <span class='doccomment'>/// The viewport&#39;s dimensions are not supported by the backend.</span>
    <span class='ident'>ViewportTooLarge</span>,

    <span class='doccomment'>/// The depth range is outside of the `(0, 1)` range.</span>
    <span class='ident'>InvalidDepthRange</span>,

    <span class='doccomment'>/// The type of a uniform doesn&#39;t match what the program requires.</span>
    <span class='ident'>UniformTypeMismatch</span> {
        <span class='doccomment'>/// Name of the uniform you are trying to bind.</span>
        <span class='ident'>name</span>: <span class='ident'>String</span>,
        <span class='doccomment'>/// The expected type.</span>
        <span class='ident'>expected</span>: <span class='ident'>uniforms</span>::<span class='ident'>UniformType</span>,
    },

    <span class='doccomment'>/// Tried to bind a uniform buffer to a single uniform value.</span>
    <span class='ident'>UniformBufferToValue</span> {
        <span class='doccomment'>/// Name of the uniform you are trying to bind.</span>
        <span class='ident'>name</span>: <span class='ident'>String</span>,
    },

    <span class='doccomment'>/// Tried to bind a single uniform value to a uniform block.</span>
    <span class='ident'>UniformValueToBlock</span> {
        <span class='doccomment'>/// Name of the uniform you are trying to bind.</span>
        <span class='ident'>name</span>: <span class='ident'>String</span>,
    },

    <span class='doccomment'>/// The layout of the content of the uniform buffer does not match the layout of the block.</span>
    <span class='ident'>UniformBlockLayoutMismatch</span> {
        <span class='doccomment'>/// Name of the block you are trying to bind.</span>
        <span class='ident'>name</span>: <span class='ident'>String</span>,
    },

    <span class='doccomment'>/// The number of vertices per patch that has been requested is not supported.</span>
    <span class='ident'>UnsupportedVerticesPerPatch</span>,

    <span class='doccomment'>/// Trying to use tessellation, but this is not supported by the underlying hardware.</span>
    <span class='ident'>TessellationNotSupported</span>,

    <span class='doccomment'>/// Using a program which contains tessellation shaders, but without submitting patches.</span>
    <span class='ident'>TessellationWithoutPatches</span>,

    <span class='doccomment'>/// Trying to use a sampler, but they are not supported by the backend.</span>
    <span class='ident'>SamplersNotSupported</span>,

    <span class='doccomment'>/// When you use instancing, all vertices sources must have the same size.</span>
    <span class='ident'>InstancesCountMismatch</span>,

    <span class='doccomment'>/// If you don&#39;t use indices, then all vertices sources must have the same size.</span>
    <span class='ident'>VerticesSourcesLengthMismatch</span>,

    <span class='doccomment'>/// You requested not to draw primitives, but this is not supported by the backend.</span>
    <span class='ident'>TransformFeedbackNotSupported</span>,
}

<span class='kw'>impl</span> <span class='ident'>std</span>::<span class='ident'>fmt</span>::<span class='ident'>Display</span> <span class='kw'>for</span> <span class='ident'>DrawError</span> {
    <span class='kw'>fn</span> <span class='ident'>fmt</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>fmt</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>std</span>::<span class='ident'>fmt</span>::<span class='ident'>Formatter</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span>(), <span class='ident'>std</span>::<span class='ident'>fmt</span>::<span class='ident'>Error</span><span class='op'>&gt;</span> {
        <span class='kw'>match</span> <span class='self'>self</span> {
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>NoDepthBuffer</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;A depth function has been requested but no \
                                                      depth buffer is available.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>AttributeTypeMismatch</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;The type of a vertex attribute in \
                                                              the vertices source doesn&#39;t match \
                                                              what the program requires.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>AttributeMissing</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;One of the attributes required by the \
                                                         program is missing from the vertex \
                                                         format.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>ViewportTooLarge</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;The viewport&#39;s dimensions are not \
                                                         supported by the backend.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>InvalidDepthRange</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;The depth range is outside of the \
                                                          `(0, 1)` range.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>UniformTypeMismatch</span> { <span class='kw-2'>ref</span> <span class='ident'>name</span>, <span class='kw-2'>ref</span> <span class='ident'>expected</span> } <span class='op'>=&gt;</span> {
                <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;The type of a uniform doesn&#39;t match what the program requires.&quot;</span>)
            },
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>UniformBufferToValue</span> { <span class='kw-2'>ref</span> <span class='ident'>name</span> } <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;Tried to bind a uniform \
                                                                          buffer to a single \
                                                                          uniform value.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>UniformValueToBlock</span> { <span class='kw-2'>ref</span> <span class='ident'>name</span> } <span class='op'>=&gt;</span> {
                <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;Tried to bind a single uniform value to a uniform block.&quot;</span>)
            },
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>UniformBlockLayoutMismatch</span> { <span class='kw-2'>ref</span> <span class='ident'>name</span> } <span class='op'>=&gt;</span> {
                <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;The layout of the content of the uniform buffer does not match \
                             the layout of the block.&quot;</span>)
            },
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>UnsupportedVerticesPerPatch</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;The number of vertices per \
                                                                    patch that has been requested \
                                                                    is not supported.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>TessellationNotSupported</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;Trying to use tessellation, but \
                                                                 this is not supported by the \
                                                                 underlying hardware.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>TessellationWithoutPatches</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;Using a program which contains \
                                                                   tessellation shaders, but \
                                                                   without submitting patches.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>SamplersNotSupported</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;Trying to use a sampler, but they are \
                                                             not supported by the backend.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>InstancesCountMismatch</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;When you use instancing, all \
                                                               vertices sources must have the \
                                                               same size&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>VerticesSourcesLengthMismatch</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;If you don&#39;t use indices, \
                                                                      then all vertices sources \
                                                                      must have the same size.&quot;</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>DrawError</span>::<span class='ident'>TransformFeedbackNotSupported</span> <span class='op'>=&gt;</span> <span class='macro'>write</span><span class='macro'>!</span>(<span class='ident'>fmt</span>, <span class='string'>&quot;Requested not to draw \
                                                                      primitves, but this is not \
                                                                      supported by the backend.&quot;</span>),
        }
    }
}

<span class='attribute'>#[<span class='ident'>doc</span>(<span class='ident'>hidden</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>BlitHelper</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='ident'>Arc</span><span class='op'>&lt;</span><span class='ident'>DisplayImpl</span><span class='op'>&gt;</span>, <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='ident'>fbo</span>::<span class='ident'>FramebufferAttachments</span><span class='op'>&gt;</span>);

<span class='doccomment'>/// Implementation of `Surface`, targeting the default framebuffer.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The back- and front-buffers are swapped when the `Frame` is destroyed. This operation is</span>
<span class='doccomment'>/// instantaneous, even when vsync is enabled.</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Frame</span> {
    <span class='ident'>display</span>: <span class='ident'>Display</span>,
    <span class='ident'>dimensions</span>: (<span class='ident'>u32</span>, <span class='ident'>u32</span>),
}

<span class='kw'>impl</span> <span class='ident'>Frame</span> {
    <span class='doccomment'>/// Stop drawing, and swap the buffers.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>finish</span>(<span class='self'>self</span>) {
    }
}

<span class='kw'>impl</span> <span class='ident'>Surface</span> <span class='kw'>for</span> <span class='ident'>Frame</span> {
    <span class='kw'>fn</span> <span class='ident'>clear</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>color</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span>(<span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>, <span class='ident'>f32</span>)<span class='op'>&gt;</span>, <span class='ident'>depth</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>f32</span><span class='op'>&gt;</span>,
             <span class='ident'>stencil</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>i32</span><span class='op'>&gt;</span>)
    {
        <span class='ident'>ops</span>::<span class='ident'>clear</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>.<span class='ident'>display</span>.<span class='ident'>context</span>, <span class='prelude-val'>None</span>, <span class='ident'>color</span>, <span class='ident'>depth</span>, <span class='ident'>stencil</span>);
    }

    <span class='kw'>fn</span> <span class='ident'>get_dimensions</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>u32</span>, <span class='ident'>u32</span>) {
        <span class='self'>self</span>.<span class='ident'>dimensions</span>
    }

    <span class='kw'>fn</span> <span class='ident'>get_depth_buffer_bits</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>u16</span><span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>capabilities</span>().<span class='ident'>depth_bits</span>
    }

    <span class='kw'>fn</span> <span class='ident'>get_stencil_buffer_bits</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>u16</span><span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>capabilities</span>().<span class='ident'>stencil_bits</span>
    }

    <span class='kw'>fn</span> <span class='ident'>draw</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span>, <span class='lifetime'>&#39;b</span>, <span class='ident'>V</span>, <span class='ident'>I</span>, <span class='ident'>U</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>vertex_buffer</span>: <span class='ident'>V</span>,
                         <span class='ident'>index_buffer</span>: <span class='kw-2'>&amp;</span><span class='ident'>I</span>, <span class='ident'>program</span>: <span class='kw-2'>&amp;</span><span class='ident'>Program</span>, <span class='ident'>uniforms</span>: <span class='ident'>U</span>,
                         <span class='ident'>draw_parameters</span>: <span class='kw-2'>&amp;</span><span class='ident'>DrawParameters</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span>(), <span class='ident'>DrawError</span><span class='op'>&gt;</span>
                         <span class='kw'>where</span> <span class='ident'>I</span>: <span class='ident'>index</span>::<span class='ident'>ToIndicesSource</span>, <span class='ident'>U</span>: <span class='ident'>uniforms</span>::<span class='ident'>Uniforms</span>,
                         <span class='ident'>V</span>: <span class='ident'>vertex</span>::<span class='ident'>MultiVerticesSource</span><span class='op'>&lt;</span><span class='lifetime'>&#39;b</span><span class='op'>&gt;</span>
    {
        <span class='kw'>use</span> <span class='ident'>index</span>::<span class='ident'>ToIndicesSource</span>;

        <span class='kw'>if</span> <span class='op'>!</span><span class='self'>self</span>.<span class='ident'>has_depth_buffer</span>() <span class='op'>&amp;&amp;</span> (<span class='ident'>draw_parameters</span>.<span class='ident'>depth_test</span>.<span class='ident'>requires_depth_buffer</span>() <span class='op'>||</span>
                <span class='ident'>draw_parameters</span>.<span class='ident'>depth_write</span>)
        {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='ident'>DrawError</span>::<span class='ident'>NoDepthBuffer</span>);
        }

        <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='ident'>viewport</span>) <span class='op'>=</span> <span class='ident'>draw_parameters</span>.<span class='ident'>viewport</span> {
            <span class='kw'>if</span> <span class='ident'>viewport</span>.<span class='ident'>width</span> <span class='op'>&gt;</span> <span class='self'>self</span>.<span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>capabilities</span>().<span class='ident'>max_viewport_dims</span>.<span class='number'>0</span>
                    <span class='kw'>as</span> <span class='ident'>u32</span>
            {
                <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='ident'>DrawError</span>::<span class='ident'>ViewportTooLarge</span>);
            }
            <span class='kw'>if</span> <span class='ident'>viewport</span>.<span class='ident'>height</span> <span class='op'>&gt;</span> <span class='self'>self</span>.<span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>capabilities</span>().<span class='ident'>max_viewport_dims</span>.<span class='number'>1</span>
                    <span class='kw'>as</span> <span class='ident'>u32</span>
            {
                <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='ident'>DrawError</span>::<span class='ident'>ViewportTooLarge</span>);
            }
        }

        <span class='ident'>ops</span>::<span class='ident'>draw</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>.<span class='ident'>display</span>, <span class='prelude-val'>None</span>, <span class='ident'>vertex_buffer</span>, <span class='ident'>index_buffer</span>.<span class='ident'>to_indices_source</span>(), <span class='ident'>program</span>,
                  <span class='ident'>uniforms</span>, <span class='ident'>draw_parameters</span>, (<span class='self'>self</span>.<span class='ident'>dimensions</span>.<span class='number'>0</span> <span class='kw'>as</span> <span class='ident'>u32</span>, <span class='self'>self</span>.<span class='ident'>dimensions</span>.<span class='number'>1</span> <span class='kw'>as</span> <span class='ident'>u32</span>))
    }

    <span class='kw'>fn</span> <span class='ident'>get_blit_helper</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>BlitHelper</span> {
        <span class='ident'>BlitHelper</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>.<span class='ident'>display</span>.<span class='ident'>context</span>, <span class='prelude-val'>None</span>)
    }
}

<span class='attribute'>#[<span class='ident'>unsafe_destructor</span>]</span>
<span class='kw'>impl</span> <span class='ident'>Drop</span> <span class='kw'>for</span> <span class='ident'>Frame</span> {
    <span class='kw'>fn</span> <span class='ident'>drop</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) {
        <span class='self'>self</span>.<span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>swap_buffers</span>();
    }
}

<span class='doccomment'>/// Objects that can build a `Display` object.</span>
<span class='kw'>pub</span> <span class='kw'>trait</span> <span class='ident'>DisplayBuild</span> {
    <span class='doccomment'>/// Build a context and a `Display` to draw on it.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Performs a compatibility check to make sure that all core elements of glium</span>
    <span class='doccomment'>/// are supported by the implementation.</span>
    <span class='kw'>fn</span> <span class='ident'>build_glium</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>Display</span>, <span class='ident'>GliumCreationError</span><span class='op'>&gt;</span>;

    <span class='doccomment'>/// Changes the settings of an existing `Display`.</span>
    <span class='kw'>fn</span> <span class='ident'>rebuild_glium</span>(<span class='self'>self</span>, <span class='kw-2'>&amp;</span><span class='ident'>Display</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span>(), <span class='ident'>GliumCreationError</span><span class='op'>&gt;</span>;
}

<span class='doccomment'>/// Error that can happen while creating a glium display.</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>, <span class='ident'>Debug</span>, <span class='ident'>PartialEq</span>, <span class='ident'>Eq</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>enum</span> <span class='ident'>GliumCreationError</span> {
    <span class='doccomment'>/// An error has happened while creating the glutin window or headless renderer.</span>
    <span class='ident'>GlutinCreationError</span>(<span class='ident'>glutin</span>::<span class='ident'>CreationError</span>),

    <span class='doccomment'>/// The OpenGL implementation is too old.</span>
    <span class='ident'>IncompatibleOpenGl</span>(<span class='ident'>String</span>),
}

<span class='kw'>impl</span> <span class='ident'>std</span>::<span class='ident'>fmt</span>::<span class='ident'>Display</span> <span class='kw'>for</span> <span class='ident'>GliumCreationError</span> {
    <span class='kw'>fn</span> <span class='ident'>fmt</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>formatter</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>std</span>::<span class='ident'>fmt</span>::<span class='ident'>Formatter</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span>(), <span class='ident'>std</span>::<span class='ident'>fmt</span>::<span class='ident'>Error</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>self_error</span> <span class='op'>=</span> <span class='self'>self</span> <span class='kw'>as</span> <span class='kw-2'>&amp;</span><span class='ident'>std</span>::<span class='ident'>error</span>::<span class='ident'>Error</span>;
        <span class='ident'>formatter</span>.<span class='ident'>write_str</span>(<span class='ident'>self_error</span>.<span class='ident'>description</span>())
    }
}

<span class='kw'>impl</span> <span class='ident'>std</span>::<span class='ident'>error</span>::<span class='ident'>Error</span> <span class='kw'>for</span> <span class='ident'>GliumCreationError</span> {
    <span class='kw'>fn</span> <span class='ident'>description</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='ident'>str</span> {
        <span class='kw'>match</span> <span class='self'>self</span> {
            <span class='kw-2'>&amp;</span><span class='ident'>GliumCreationError</span>::<span class='ident'>GlutinCreationError</span>(_) <span class='op'>=&gt;</span> <span class='string'>&quot;Error while creating glutin window or headless renderer&quot;</span>,
            <span class='kw-2'>&amp;</span><span class='ident'>GliumCreationError</span>::<span class='ident'>IncompatibleOpenGl</span>(_) <span class='op'>=&gt;</span> <span class='string'>&quot;The OpenGL implementation is too old to work with glium&quot;</span>,
        }
    }

    <span class='kw'>fn</span> <span class='ident'>cause</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='kw-2'>&amp;</span><span class='ident'>std</span>::<span class='ident'>error</span>::<span class='ident'>Error</span><span class='op'>&gt;</span> {
        <span class='kw'>match</span> <span class='self'>self</span> {
            <span class='kw-2'>&amp;</span><span class='ident'>GliumCreationError</span>::<span class='ident'>GlutinCreationError</span>(<span class='kw-2'>ref</span> <span class='ident'>err</span>) <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='ident'>err</span> <span class='kw'>as</span> <span class='kw-2'>&amp;</span><span class='ident'>std</span>::<span class='ident'>error</span>::<span class='ident'>Error</span>),
            <span class='kw-2'>&amp;</span><span class='ident'>GliumCreationError</span>::<span class='ident'>IncompatibleOpenGl</span>(_) <span class='op'>=&gt;</span> <span class='prelude-val'>None</span>,
        }
    }
}

<span class='kw'>impl</span> <span class='ident'>std</span>::<span class='ident'>error</span>::<span class='ident'>FromError</span><span class='op'>&lt;</span><span class='ident'>glutin</span>::<span class='ident'>CreationError</span><span class='op'>&gt;</span> <span class='kw'>for</span> <span class='ident'>GliumCreationError</span> {
    <span class='kw'>fn</span> <span class='ident'>from_error</span>(<span class='ident'>err</span>: <span class='ident'>glutin</span>::<span class='ident'>CreationError</span>) <span class='op'>-&gt;</span> <span class='ident'>GliumCreationError</span> {
        <span class='ident'>GliumCreationError</span>::<span class='ident'>GlutinCreationError</span>(<span class='ident'>err</span>)
    }
}

<span class='kw'>impl</span> <span class='ident'>DisplayBuild</span> <span class='kw'>for</span> <span class='ident'>glutin</span>::<span class='ident'>WindowBuilder</span><span class='op'>&lt;</span><span class='lifetime'>&#39;static</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>build_glium</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>Display</span>, <span class='ident'>GliumCreationError</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> (<span class='ident'>context</span>, <span class='ident'>shared_debug</span>) <span class='op'>=</span> <span class='macro'>try</span><span class='macro'>!</span>(<span class='ident'>context</span>::<span class='ident'>new_from_window</span>(<span class='self'>self</span>));

        <span class='kw'>let</span> <span class='ident'>display</span> <span class='op'>=</span> <span class='ident'>Display</span> {
            <span class='ident'>context</span>: <span class='ident'>Arc</span>::<span class='ident'>new</span>(<span class='ident'>DisplayImpl</span> {
                <span class='ident'>context</span>: <span class='ident'>context</span>,
                <span class='ident'>debug_callback</span>: <span class='ident'>Mutex</span>::<span class='ident'>new</span>(<span class='prelude-val'>None</span>),
                <span class='ident'>shared_debug_output</span>: <span class='ident'>shared_debug</span>,
                <span class='ident'>framebuffer_objects</span>: <span class='prelude-val'>Some</span>(<span class='ident'>fbo</span>::<span class='ident'>FramebuffersContainer</span>::<span class='ident'>new</span>()),
                <span class='ident'>vertex_array_objects</span>: <span class='ident'>Mutex</span>::<span class='ident'>new</span>(<span class='ident'>HashMap</span>::<span class='ident'>with_hash_state</span>(<span class='ident'>Default</span>::<span class='ident'>default</span>())),
                <span class='ident'>samplers</span>: <span class='ident'>Mutex</span>::<span class='ident'>new</span>(<span class='ident'>HashMap</span>::<span class='ident'>with_hash_state</span>(<span class='ident'>Default</span>::<span class='ident'>default</span>())),
            }),
        };

        <span class='ident'>display</span>.<span class='ident'>init_debug_callback</span>();
        <span class='prelude-val'>Ok</span>(<span class='ident'>display</span>)
    }

    <span class='kw'>fn</span> <span class='ident'>rebuild_glium</span>(<span class='self'>self</span>, <span class='ident'>display</span>: <span class='kw-2'>&amp;</span><span class='ident'>Display</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span>(), <span class='ident'>GliumCreationError</span><span class='op'>&gt;</span> {
        <span class='comment'>// framebuffer objects and vertex array objects aren&#39;t shared, so we have to destroy them</span>
        <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='kw-2'>ref</span> <span class='ident'>fbos</span>) <span class='op'>=</span> <span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>framebuffer_objects</span> {
            <span class='ident'>fbos</span>.<span class='ident'>purge_all</span>(<span class='kw-2'>&amp;</span><span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>context</span>);
        }

        {
            <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>vaos</span> <span class='op'>=</span> <span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>vertex_array_objects</span>.<span class='ident'>lock</span>().<span class='ident'>unwrap</span>();
            <span class='ident'>vaos</span>.<span class='ident'>clear</span>();
        }

        <span class='ident'>display</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>rebuild</span>(<span class='self'>self</span>)
    }
}

<span class='attribute'>#[<span class='ident'>cfg</span>(<span class='ident'>feature</span> <span class='op'>=</span> <span class='string'>&quot;headless&quot;</span>)]</span>
<span class='kw'>impl</span> <span class='ident'>DisplayBuild</span> <span class='kw'>for</span> <span class='ident'>glutin</span>::<span class='ident'>HeadlessRendererBuilder</span> {
    <span class='kw'>fn</span> <span class='ident'>build_glium</span>(<span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>Display</span>, <span class='ident'>GliumCreationError</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> (<span class='ident'>context</span>, <span class='ident'>shared_debug</span>) <span class='op'>=</span> <span class='macro'>try</span><span class='macro'>!</span>(<span class='ident'>context</span>::<span class='ident'>new_from_headless</span>(<span class='self'>self</span>));

        <span class='kw'>let</span> <span class='ident'>display</span> <span class='op'>=</span> <span class='ident'>Display</span> {
            <span class='ident'>context</span>: <span class='ident'>Arc</span>::<span class='ident'>new</span>(<span class='ident'>DisplayImpl</span> {
                <span class='ident'>context</span>: <span class='ident'>context</span>,
                <span class='ident'>debug_callback</span>: <span class='ident'>Mutex</span>::<span class='ident'>new</span>(<span class='prelude-val'>None</span>),
                <span class='ident'>shared_debug_output</span>: <span class='ident'>shared_debug</span>,
                <span class='ident'>framebuffer_objects</span>: <span class='prelude-val'>Some</span>(<span class='ident'>fbo</span>::<span class='ident'>FramebuffersContainer</span>::<span class='ident'>new</span>()),
                <span class='ident'>vertex_array_objects</span>: <span class='ident'>Mutex</span>::<span class='ident'>new</span>(<span class='ident'>HashMap</span>::<span class='ident'>with_hash_state</span>(<span class='ident'>Default</span>::<span class='ident'>default</span>())),
                <span class='ident'>samplers</span>: <span class='ident'>Mutex</span>::<span class='ident'>new</span>(<span class='ident'>HashMap</span>::<span class='ident'>with_hash_state</span>(<span class='ident'>Default</span>::<span class='ident'>default</span>())),
            }),
        };

        <span class='ident'>display</span>.<span class='ident'>init_debug_callback</span>();
        <span class='prelude-val'>Ok</span>(<span class='ident'>display</span>)
    }

    <span class='kw'>fn</span> <span class='ident'>rebuild_glium</span>(<span class='self'>self</span>, _: <span class='kw-2'>&amp;</span><span class='ident'>Display</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span>(), <span class='ident'>GliumCreationError</span><span class='op'>&gt;</span> {
        <span class='macro'>unimplemented</span><span class='macro'>!</span>()
    }
}

<span class='doccomment'>/// The main object of this library. Controls the whole display.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This object contains a smart pointer to the real implementation.</span>
<span class='doccomment'>/// Cloning the display allows you to easily share the `Display` object throughout</span>
<span class='doccomment'>/// your program and between threads.</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>Display</span> {
    <span class='ident'>context</span>: <span class='ident'>Arc</span><span class='op'>&lt;</span><span class='ident'>DisplayImpl</span><span class='op'>&gt;</span>,
}

<span class='kw'>struct</span> <span class='ident'>DisplayImpl</span> {
    <span class='comment'>// contains everything related to the current context and its state</span>
    <span class='ident'>context</span>: <span class='ident'>context</span>::<span class='ident'>Context</span>,

    <span class='comment'>// the callback used for debug messages</span>
    <span class='ident'>debug_callback</span>: <span class='ident'>Mutex</span><span class='op'>&lt;</span><span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Box</span><span class='op'>&lt;</span><span class='ident'>FnMut</span>(<span class='ident'>String</span>, <span class='ident'>debug</span>::<span class='ident'>Source</span>, <span class='ident'>debug</span>::<span class='ident'>MessageType</span>, <span class='ident'>debug</span>::<span class='ident'>Severity</span>)
                                     <span class='op'>+</span> <span class='ident'>Send</span> <span class='op'>+</span> <span class='ident'>Sync</span><span class='op'>&gt;&gt;</span><span class='op'>&gt;</span>,

    <span class='comment'>// holding the Arc to SharedDebugOutput</span>
    <span class='ident'>shared_debug_output</span>: <span class='ident'>Arc</span><span class='op'>&lt;</span><span class='ident'>context</span>::<span class='ident'>SharedDebugOutput</span><span class='op'>&gt;</span>,

    <span class='comment'>// we maintain a list of FBOs</span>
    <span class='comment'>// the option is here to destroy the container</span>
    <span class='ident'>framebuffer_objects</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>fbo</span>::<span class='ident'>FramebuffersContainer</span><span class='op'>&gt;</span>,

    <span class='comment'>// we maintain a list of VAOs for each vertexbuffer-indexbuffer-program association</span>
    <span class='comment'>// the key is a (buffers-list, program) ; the buffers list must be sorted</span>
    <span class='ident'>vertex_array_objects</span>: <span class='ident'>Mutex</span><span class='op'>&lt;</span><span class='ident'>HashMap</span><span class='op'>&lt;</span>(<span class='ident'>Vec</span><span class='op'>&lt;</span><span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLuint</span><span class='op'>&gt;</span>, <span class='ident'>Handle</span>),
                                        <span class='ident'>vertex_array_object</span>::<span class='ident'>VertexArrayObject</span>, <span class='ident'>DefaultState</span><span class='op'>&lt;</span><span class='ident'>util</span>::<span class='ident'>FnvHasher</span><span class='op'>&gt;&gt;</span><span class='op'>&gt;</span>,

    <span class='comment'>// we maintain a list of samplers for each possible behavior</span>
    <span class='ident'>samplers</span>: <span class='ident'>Mutex</span><span class='op'>&lt;</span><span class='ident'>HashMap</span><span class='op'>&lt;</span><span class='ident'>uniforms</span>::<span class='ident'>SamplerBehavior</span>, <span class='ident'>sampler_object</span>::<span class='ident'>SamplerObject</span>, 
                    <span class='ident'>DefaultState</span><span class='op'>&lt;</span><span class='ident'>util</span>::<span class='ident'>FnvHasher</span><span class='op'>&gt;&gt;</span><span class='op'>&gt;</span>,
}

<span class='kw'>impl</span> <span class='ident'>Display</span> {
    <span class='doccomment'>/// Reads all events received by the window.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This iterator polls for events and can be exhausted.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>poll_events</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>PollEventsIter</span> {
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>poll_events</span>()
    }

    <span class='doccomment'>/// Reads all events received by the window.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>wait_events</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>WaitEventsIter</span> {
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>wait_events</span>()
    }

    <span class='doccomment'>/// Returns the underlying window, or `None` if glium uses a headless context.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>get_window</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>RwLockReadGuard</span><span class='op'>&lt;</span><span class='ident'>glutin</span>::<span class='ident'>Window</span><span class='op'>&gt;&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>get_window</span>()
    }

    <span class='doccomment'>/// Returns the dimensions of the main framebuffer.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>get_framebuffer_dimensions</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>u32</span>, <span class='ident'>u32</span>) {
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>get_framebuffer_dimensions</span>()
    }

    <span class='doccomment'>/// Returns the OpenGL version of the current context.</span>
    <span class='comment'>// TODO: return API as well</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>get_opengl_version</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Version</span> {
        <span class='op'>*</span><span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>get_version</span>()
    }

    <span class='doccomment'>/// Start drawing on the backbuffer.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This function returns a `Frame`, which can be used to draw on it. When the `Frame` is</span>
    <span class='doccomment'>/// destroyed, the buffers are swapped.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Note that destroying a `Frame` is immediate, even if vsync is enabled.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>draw</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Frame</span> {
        <span class='ident'>Frame</span> {
            <span class='ident'>display</span>: <span class='self'>self</span>.<span class='ident'>clone</span>(),
            <span class='ident'>dimensions</span>: <span class='self'>self</span>.<span class='ident'>get_framebuffer_dimensions</span>(),
        }
    }

    <span class='doccomment'>/// Returns the maximum value that can be used for anisotropic filtering, or `None`</span>
    <span class='doccomment'>/// if the hardware doesn&#39;t support it.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>get_max_anisotropy_support</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>u16</span><span class='op'>&gt;</span> {
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>capabilities</span>().<span class='ident'>max_texture_max_anisotropy</span>.<span class='ident'>map</span>(<span class='op'>|</span><span class='ident'>v</span><span class='op'>|</span> <span class='ident'>v</span> <span class='kw'>as</span> <span class='ident'>u16</span>)
    }

    <span class='doccomment'>/// Returns the maximum dimensions of the viewport.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Glium will panic if you request a larger viewport than this when drawing.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>get_max_viewport_dimensions</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='ident'>u32</span>, <span class='ident'>u32</span>) {
        <span class='kw'>let</span> <span class='ident'>d</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>capabilities</span>().<span class='ident'>max_viewport_dims</span>;
        (<span class='ident'>d</span>.<span class='number'>0</span> <span class='kw'>as</span> <span class='ident'>u32</span>, <span class='ident'>d</span>.<span class='number'>1</span> <span class='kw'>as</span> <span class='ident'>u32</span>)
    }

    <span class='doccomment'>/// Releases the shader compiler, indicating that no new programs will be created for a while.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// # Features</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This method is always available, but is a no-op if it&#39;s not available in</span>
    <span class='doccomment'>/// the implementation.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>release_shader_compiler</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) {
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>exec</span>(<span class='kw'>move</span> <span class='op'>|</span><span class='ident'>ctxt</span><span class='op'>|</span> {
            <span class='kw'>unsafe</span> {
                <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>version</span> <span class='op'>&gt;=</span> <span class='kw-2'>&amp;</span><span class='ident'>context</span>::<span class='ident'>GlVersion</span>(<span class='ident'>Api</span>::<span class='ident'>GlEs</span>, <span class='number'>2</span>, <span class='number'>0</span>) <span class='op'>||</span>
                    <span class='ident'>ctxt</span>.<span class='ident'>version</span> <span class='op'>&gt;=</span> <span class='kw-2'>&amp;</span><span class='ident'>context</span>::<span class='ident'>GlVersion</span>(<span class='ident'>Api</span>::<span class='ident'>Gl</span>, <span class='number'>4</span>, <span class='number'>1</span>)
                {
                    <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>ReleaseShaderCompiler</span>();
                }
            }
        });
    }

    <span class='doccomment'>/// Returns an estimate of the amount of video memory available in bytes.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if no estimate is available.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>get_free_video_memory</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>usize</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> (<span class='ident'>tx</span>, <span class='ident'>rx</span>) <span class='op'>=</span> <span class='ident'>channel</span>();

        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>exec</span>(<span class='kw'>move</span> <span class='op'>|</span><span class='ident'>ctxt</span><span class='op'>|</span> {
            <span class='kw'>unsafe</span> {
                <span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>mem</span>;
                <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>value</span>: [<span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLint</span>; <span class='number'>4</span>] <span class='op'>=</span> <span class='ident'>mem</span>::<span class='ident'>uninitialized</span>();

                <span class='kw'>let</span> <span class='ident'>value</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>extensions</span>.<span class='ident'>gl_nvx_gpu_memory_info</span> {
                    <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>GetIntegerv</span>(<span class='ident'>gl</span>::<span class='ident'>GPU_MEMORY_INFO_CURRENT_AVAILABLE_VIDMEM_NVX</span>,
                                   <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>value</span>[<span class='number'>0</span>]);
                    <span class='prelude-val'>Some</span>(<span class='ident'>value</span>[<span class='number'>0</span>])

                } <span class='kw'>else</span> <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>extensions</span>.<span class='ident'>gl_ati_meminfo</span> {
                    <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>GetIntegerv</span>(<span class='ident'>gl</span>::<span class='ident'>TEXTURE_FREE_MEMORY_ATI</span>, <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>value</span>[<span class='number'>0</span>]);
                    <span class='prelude-val'>Some</span>(<span class='ident'>value</span>[<span class='number'>0</span>])

                } <span class='kw'>else</span> {
                    <span class='prelude-val'>None</span>
                };

                <span class='ident'>tx</span>.<span class='ident'>send</span>(<span class='ident'>value</span>).<span class='ident'>ok</span>();
            }
        });

        <span class='ident'>rx</span>.<span class='ident'>recv</span>().<span class='ident'>unwrap</span>().<span class='ident'>map</span>(<span class='op'>|</span><span class='ident'>v</span><span class='op'>|</span> <span class='ident'>v</span> <span class='kw'>as</span> <span class='ident'>usize</span> <span class='op'>*</span> <span class='number'>1024</span>)
    }

    <span class='comment'>// TODO: do this more properly</span>
    <span class='kw'>fn</span> <span class='ident'>init_debug_callback</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) {
        <span class='kw'>if</span> <span class='macro'>cfg</span><span class='macro'>!</span>(<span class='ident'>ndebug</span>) {
            <span class='kw'>return</span>;
        }

        <span class='kw'>if</span> ::<span class='ident'>std</span>::<span class='ident'>env</span>::<span class='ident'>var</span>(<span class='string'>&quot;GLIUM_DISABLE_DEBUG_OUTPUT&quot;</span>).<span class='ident'>is_ok</span>() {
            <span class='kw'>return</span>;
        }

        <span class='comment'>// this is the C callback</span>
        <span class='kw'>extern</span> <span class='string'>&quot;system&quot;</span> <span class='kw'>fn</span> <span class='ident'>callback_wrapper</span>(<span class='ident'>source</span>: <span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLenum</span>, <span class='ident'>ty</span>: <span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLenum</span>,
            <span class='ident'>id</span>: <span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLuint</span>, <span class='ident'>severity</span>: <span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLenum</span>, <span class='ident'>_length</span>: <span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLsizei</span>,
            <span class='ident'>message</span>: <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>gl</span>::<span class='ident'>types</span>::<span class='ident'>GLchar</span>, <span class='ident'>user_param</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>libc</span>::<span class='ident'>c_void</span>)
        {
            <span class='kw'>let</span> <span class='ident'>user_param</span> <span class='op'>=</span> <span class='ident'>user_param</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>context</span>::<span class='ident'>SharedDebugOutput</span>;
            <span class='kw'>let</span> <span class='ident'>user_param</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>user_param</span>.<span class='ident'>as_ref</span>().<span class='ident'>unwrap</span>() };

            <span class='kw'>if</span> (<span class='ident'>severity</span> <span class='op'>==</span> <span class='ident'>gl</span>::<span class='ident'>DEBUG_SEVERITY_HIGH</span> <span class='op'>||</span> <span class='ident'>severity</span> <span class='op'>==</span> <span class='ident'>gl</span>::<span class='ident'>DEBUG_SEVERITY_MEDIUM</span>) <span class='op'>&amp;&amp;</span> 
               (<span class='ident'>ty</span> <span class='op'>==</span> <span class='ident'>gl</span>::<span class='ident'>DEBUG_TYPE_ERROR</span> <span class='op'>||</span> <span class='ident'>ty</span> <span class='op'>==</span> <span class='ident'>gl</span>::<span class='ident'>DEBUG_TYPE_UNDEFINED_BEHAVIOR</span> <span class='op'>||</span>
                <span class='ident'>ty</span> <span class='op'>==</span> <span class='ident'>gl</span>::<span class='ident'>DEBUG_TYPE_PORTABILITY</span> <span class='op'>||</span> <span class='ident'>ty</span> <span class='op'>==</span> <span class='ident'>gl</span>::<span class='ident'>DEBUG_TYPE_DEPRECATED_BEHAVIOR</span>)
            {
                <span class='kw'>if</span> <span class='ident'>user_param</span>.<span class='ident'>report_errors</span>.<span class='ident'>load</span>(<span class='ident'>std</span>::<span class='ident'>sync</span>::<span class='ident'>atomic</span>::<span class='ident'>Ordering</span>::<span class='ident'>Relaxed</span>) {
                    <span class='kw'>let</span> <span class='ident'>message</span> <span class='op'>=</span> <span class='kw'>unsafe</span> {
                        <span class='ident'>String</span>::<span class='ident'>from_utf8</span>(<span class='ident'>std</span>::<span class='ident'>ffi</span>::<span class='ident'>c_str_to_bytes</span>(<span class='kw-2'>&amp;</span><span class='ident'>message</span>).<span class='ident'>to_vec</span>()).<span class='ident'>unwrap</span>()
                    };

                    <span class='macro'>panic</span><span class='macro'>!</span>(<span class='string'>&quot;Debug message with high or medium severity: `{}`.\n\
                            Please report this error: https://github.com/tomaka/glium/issues&quot;</span>,
                            <span class='ident'>message</span>);
                }
            }
        }

        <span class='kw'>struct</span> <span class='ident'>SharedDebugOutputPtr</span>(<span class='op'>*</span><span class='kw'>const</span> <span class='ident'>context</span>::<span class='ident'>SharedDebugOutput</span>);
        <span class='kw'>unsafe</span> <span class='kw'>impl</span> <span class='ident'>Send</span> <span class='kw'>for</span> <span class='ident'>SharedDebugOutputPtr</span> {}
        <span class='kw'>let</span> <span class='ident'>shared_debug_output_ptr</span> <span class='op'>=</span> <span class='ident'>SharedDebugOutputPtr</span>(<span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>shared_debug_output</span>.<span class='ident'>deref</span>());

        <span class='comment'>// enabling the callback</span>
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>exec</span>(<span class='kw'>move</span> <span class='op'>|</span><span class='ident'>ctxt</span><span class='op'>|</span> {
            <span class='kw'>unsafe</span> {
                <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>version</span> <span class='op'>&gt;=</span> <span class='kw-2'>&amp;</span><span class='ident'>context</span>::<span class='ident'>GlVersion</span>(<span class='ident'>Api</span>::<span class='ident'>Gl</span>, <span class='number'>4</span>,<span class='number'>5</span>) <span class='op'>||</span> <span class='ident'>ctxt</span>.<span class='ident'>extensions</span>.<span class='ident'>gl_khr_debug</span> <span class='op'>||</span>
                    <span class='ident'>ctxt</span>.<span class='ident'>extensions</span>.<span class='ident'>gl_arb_debug_output</span>
                {
                    <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>state</span>.<span class='ident'>enabled_debug_output_synchronous</span> <span class='op'>!=</span> <span class='boolval'>true</span> {
                        <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>Enable</span>(<span class='ident'>gl</span>::<span class='ident'>DEBUG_OUTPUT_SYNCHRONOUS</span>);
                        <span class='ident'>ctxt</span>.<span class='ident'>state</span>.<span class='ident'>enabled_debug_output_synchronous</span> <span class='op'>=</span> <span class='boolval'>true</span>;
                    }

                    <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>version</span> <span class='op'>&gt;=</span> <span class='kw-2'>&amp;</span><span class='ident'>context</span>::<span class='ident'>GlVersion</span>(<span class='ident'>Api</span>::<span class='ident'>Gl</span>, <span class='number'>4</span>,<span class='number'>5</span>) <span class='op'>||</span> <span class='ident'>ctxt</span>.<span class='ident'>extensions</span>.<span class='ident'>gl_khr_debug</span> {
                        <span class='comment'>// TODO: with GLES, the GL_KHR_debug function has a `KHR` suffix</span>
                        <span class='comment'>//       but with GL only, it doesn&#39;t have one</span>
                        <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>DebugMessageCallback</span>(<span class='ident'>callback_wrapper</span>, <span class='ident'>shared_debug_output_ptr</span>.<span class='number'>0</span>
                                                                         <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>libc</span>::<span class='ident'>c_void</span>);
                        <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>DebugMessageControl</span>(<span class='ident'>gl</span>::<span class='ident'>DONT_CARE</span>, <span class='ident'>gl</span>::<span class='ident'>DONT_CARE</span>, <span class='ident'>gl</span>::<span class='ident'>DONT_CARE</span>, <span class='number'>0</span>,
                                                    <span class='ident'>std</span>::<span class='ident'>ptr</span>::<span class='ident'>null</span>(), <span class='ident'>gl</span>::<span class='ident'>TRUE</span>);

                        <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>state</span>.<span class='ident'>enabled_debug_output</span> <span class='op'>!=</span> <span class='prelude-val'>Some</span>(<span class='boolval'>true</span>) {
                            <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>Enable</span>(<span class='ident'>gl</span>::<span class='ident'>DEBUG_OUTPUT</span>);
                            <span class='ident'>ctxt</span>.<span class='ident'>state</span>.<span class='ident'>enabled_debug_output</span> <span class='op'>=</span> <span class='prelude-val'>Some</span>(<span class='boolval'>true</span>);
                        }

                    } <span class='kw'>else</span> {
                        <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>DebugMessageCallbackARB</span>(<span class='ident'>callback_wrapper</span>, <span class='ident'>shared_debug_output_ptr</span>.<span class='number'>0</span>
                                                                            <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>libc</span>::<span class='ident'>c_void</span>);
                        <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>DebugMessageControlARB</span>(<span class='ident'>gl</span>::<span class='ident'>DONT_CARE</span>, <span class='ident'>gl</span>::<span class='ident'>DONT_CARE</span>, <span class='ident'>gl</span>::<span class='ident'>DONT_CARE</span>,
                                                       <span class='number'>0</span>, <span class='ident'>std</span>::<span class='ident'>ptr</span>::<span class='ident'>null</span>(), <span class='ident'>gl</span>::<span class='ident'>TRUE</span>);

                        <span class='ident'>ctxt</span>.<span class='ident'>state</span>.<span class='ident'>enabled_debug_output</span> <span class='op'>=</span> <span class='prelude-val'>Some</span>(<span class='boolval'>true</span>);
                    }
                }
            }
        });
    }

    <span class='doccomment'>/// Reads the content of the front buffer.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// You will only see the data that has finished being drawn.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This function can return any type that implements `Texture2dData`.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// ## Example</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// ```no_run</span>
    <span class='doccomment'>/// # extern crate glium;</span>
    <span class='doccomment'>/// # extern crate glutin;</span>
    <span class='doccomment'>/// # fn main() {</span>
    <span class='doccomment'>/// # let display: glium::Display = unsafe { ::std::mem::uninitialized() };</span>
    <span class='doccomment'>/// let pixels: Vec&lt;Vec&lt;(u8, u8, u8)&gt;&gt; = display.read_front_buffer();</span>
    <span class='doccomment'>/// # }</span>
    <span class='doccomment'>/// ```</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>read_front_buffer</span><span class='op'>&lt;</span><span class='ident'>P</span>, <span class='ident'>T</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>T</span>          <span class='comment'>// TODO: remove Clone for P</span>
                                   <span class='kw'>where</span> <span class='ident'>P</span>: <span class='ident'>texture</span>::<span class='ident'>PixelValue</span> <span class='op'>+</span> <span class='ident'>Clone</span> <span class='op'>+</span> <span class='ident'>Send</span>,
                                   <span class='ident'>T</span>: <span class='ident'>texture</span>::<span class='ident'>Texture2dDataSink</span><span class='op'>&lt;</span><span class='ident'>Data</span> <span class='op'>=</span> <span class='ident'>P</span><span class='op'>&gt;</span>
    {
        <span class='ident'>ops</span>::<span class='ident'>read_from_default_fb</span>(<span class='ident'>gl</span>::<span class='ident'>FRONT_LEFT</span>, <span class='self'>self</span>)
    }

    <span class='doccomment'>/// Execute an arbitrary closure with the OpenGL context active. Useful if another</span>
    <span class='doccomment'>/// component needs to directly manipulate OpenGL state.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// **If action manipulates any OpenGL state, it must be restored before action</span>
    <span class='doccomment'>/// completes.**</span>
    <span class='kw'>pub</span> <span class='kw'>unsafe</span> <span class='kw'>fn</span> <span class='ident'>exec_in_context</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span>, <span class='ident'>T</span>, <span class='ident'>F</span><span class='op'>&gt;</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>action</span>: <span class='ident'>F</span>) <span class='op'>-&gt;</span> <span class='ident'>T</span>
                                            <span class='kw'>where</span> <span class='ident'>T</span>: <span class='ident'>Send</span> <span class='op'>+</span> <span class='lifetime'>&#39;static</span>,
                                            <span class='ident'>F</span>: <span class='ident'>FnOnce</span>() <span class='op'>-&gt;</span> <span class='ident'>T</span> <span class='op'>+</span> <span class='lifetime'>&#39;a</span>
    {
        <span class='kw'>let</span> (<span class='ident'>tx</span>, <span class='ident'>rx</span>) <span class='op'>=</span> <span class='ident'>channel</span>();
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>exec_maybe_sync</span>(<span class='boolval'>true</span>, <span class='kw'>move</span> <span class='op'>|</span><span class='ident'>ctxt</span><span class='op'>|</span> {
            <span class='ident'>tx</span>.<span class='ident'>send</span>(<span class='ident'>action</span>()).<span class='ident'>ok</span>();
        });

        <span class='ident'>rx</span>.<span class='ident'>recv</span>().<span class='ident'>unwrap</span>()
    }

    <span class='doccomment'>/// Asserts that there are no OpenGL errors pending.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This function should be used in tests.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>assert_no_error</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) {
        <span class='kw'>let</span> (<span class='ident'>tx</span>, <span class='ident'>rx</span>) <span class='op'>=</span> <span class='ident'>channel</span>();

        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>exec</span>(<span class='kw'>move</span> <span class='op'>|</span><span class='kw-2'>mut</span> <span class='ident'>ctxt</span><span class='op'>|</span> {
            <span class='ident'>tx</span>.<span class='ident'>send</span>(<span class='ident'>get_gl_error</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ctxt</span>)).<span class='ident'>ok</span>();
        });

        <span class='kw'>match</span> <span class='ident'>rx</span>.<span class='ident'>recv</span>().<span class='ident'>unwrap</span>() {
            <span class='prelude-val'>Some</span>(<span class='ident'>msg</span>) <span class='op'>=&gt;</span> <span class='macro'>panic</span><span class='macro'>!</span>(<span class='string'>&quot;{}&quot;</span>, <span class='ident'>msg</span>),
            <span class='prelude-val'>None</span> <span class='op'>=&gt;</span> ()
        };
    }

    <span class='doccomment'>/// Waits until all the previous commands have finished being executed.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// When you execute OpenGL functions, they are not executed immediately. Instead they are</span>
    <span class='doccomment'>/// put in a queue. This function waits until all commands have finished being executed, and</span>
    <span class='doccomment'>/// the queue is empty.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// **You don&#39;t need to call this function manually, except when running benchmarks.**</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>synchronize</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) {
        <span class='kw'>let</span> (<span class='ident'>tx</span>, <span class='ident'>rx</span>) <span class='op'>=</span> <span class='ident'>channel</span>();

        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>context</span>.<span class='ident'>exec</span>(<span class='kw'>move</span> <span class='op'>|</span><span class='ident'>ctxt</span><span class='op'>|</span> {
            <span class='kw'>unsafe</span> { <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>Finish</span>(); }
            <span class='ident'>tx</span>.<span class='ident'>send</span>(()).<span class='ident'>ok</span>();
        });

        <span class='ident'>rx</span>.<span class='ident'>recv</span>().<span class='ident'>unwrap</span>();
    }
}

<span class='comment'>// this destructor is here because objects in `Display` contain an `Arc&lt;DisplayImpl&gt;`,</span>
<span class='comment'>// which would lead to a leak</span>
<span class='kw'>impl</span> <span class='ident'>Drop</span> <span class='kw'>for</span> <span class='ident'>DisplayImpl</span> {
    <span class='kw'>fn</span> <span class='ident'>drop</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) {
        <span class='comment'>// disabling callback</span>
        <span class='self'>self</span>.<span class='ident'>context</span>.<span class='ident'>exec</span>(<span class='kw'>move</span> <span class='op'>|</span><span class='ident'>ctxt</span><span class='op'>|</span> {
            <span class='kw'>unsafe</span> {
                <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>state</span>.<span class='ident'>enabled_debug_output</span> <span class='op'>!=</span> <span class='prelude-val'>Some</span>(<span class='boolval'>false</span>) {
                    <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>version</span> <span class='op'>&gt;=</span> <span class='kw-2'>&amp;</span><span class='ident'>context</span>::<span class='ident'>GlVersion</span>(<span class='ident'>Api</span>::<span class='ident'>Gl</span>, <span class='number'>4</span>,<span class='number'>5</span>) <span class='op'>||</span> <span class='ident'>ctxt</span>.<span class='ident'>extensions</span>.<span class='ident'>gl_khr_debug</span> {
                        <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>Disable</span>(<span class='ident'>gl</span>::<span class='ident'>DEBUG_OUTPUT</span>);
                    } <span class='kw'>else</span> <span class='kw'>if</span> <span class='ident'>ctxt</span>.<span class='ident'>extensions</span>.<span class='ident'>gl_arb_debug_output</span> {
                        <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>DebugMessageCallbackARB</span>(<span class='ident'>std</span>::<span class='ident'>mem</span>::<span class='ident'>transmute</span>(<span class='number'>0usize</span>),
                                                        <span class='ident'>std</span>::<span class='ident'>ptr</span>::<span class='ident'>null</span>());
                    }

                    <span class='ident'>ctxt</span>.<span class='ident'>state</span>.<span class='ident'>enabled_debug_output</span> <span class='op'>=</span> <span class='prelude-val'>Some</span>(<span class='boolval'>false</span>);
                    <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>Finish</span>();
                }
            }
        });

        {
            <span class='kw'>let</span> <span class='ident'>fbos</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>framebuffer_objects</span>.<span class='ident'>take</span>();
            <span class='ident'>fbos</span>.<span class='ident'>unwrap</span>().<span class='ident'>cleanup</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>.<span class='ident'>context</span>);
        }

        {
            <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>vaos</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>vertex_array_objects</span>.<span class='ident'>lock</span>().<span class='ident'>unwrap</span>();
            <span class='ident'>vaos</span>.<span class='ident'>clear</span>();
        }

        {
            <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>samplers</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>samplers</span>.<span class='ident'>lock</span>().<span class='ident'>unwrap</span>();
            <span class='ident'>samplers</span>.<span class='ident'>clear</span>();
        }
    }
}

<span class='attribute'>#[<span class='ident'>allow</span>(<span class='ident'>dead_code</span>)]</span>
<span class='kw'>fn</span> <span class='ident'>get_gl_error</span>(<span class='ident'>ctxt</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>context</span>::<span class='ident'>CommandContext</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='kw-2'>&amp;</span><span class='lifetime'>&#39;static</span> <span class='ident'>str</span><span class='op'>&gt;</span> {
    <span class='kw'>match</span> <span class='kw'>unsafe</span> { <span class='ident'>ctxt</span>.<span class='ident'>gl</span>.<span class='ident'>GetError</span>() } {
        <span class='ident'>gl</span>::<span class='ident'>NO_ERROR</span> <span class='op'>=&gt;</span> <span class='prelude-val'>None</span>,
        <span class='ident'>gl</span>::<span class='ident'>INVALID_ENUM</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;GL_INVALID_ENUM&quot;</span>),
        <span class='ident'>gl</span>::<span class='ident'>INVALID_VALUE</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;GL_INVALID_VALUE&quot;</span>),
        <span class='ident'>gl</span>::<span class='ident'>INVALID_OPERATION</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;GL_INVALID_OPERATION&quot;</span>),
        <span class='ident'>gl</span>::<span class='ident'>INVALID_FRAMEBUFFER_OPERATION</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;GL_INVALID_FRAMEBUFFER_OPERATION&quot;</span>),
        <span class='ident'>gl</span>::<span class='ident'>OUT_OF_MEMORY</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;GL_OUT_OF_MEMORY&quot;</span>),
        <span class='ident'>gl</span>::<span class='ident'>STACK_UNDERFLOW</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;GL_STACK_UNDERFLOW&quot;</span>),
        <span class='ident'>gl</span>::<span class='ident'>STACK_OVERFLOW</span> <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;GL_STACK_OVERFLOW&quot;</span>),
        _ <span class='op'>=&gt;</span> <span class='prelude-val'>Some</span>(<span class='string'>&quot;Unknown glGetError return value&quot;</span>)
    }
}
</pre>
</section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div class="shortcuts">
            <h1>Keyboard shortcuts</h1>
            <dl>
                <dt>?</dt>
                <dd>Show this help dialog</dd>
                <dt>S</dt>
                <dd>Focus the search field</dd>
                <dt>&larrb;</dt>
                <dd>Move up in search results</dd>
                <dt>&rarrb;</dt>
                <dd>Move down in search results</dd>
                <dt>&#9166;</dt>
                <dd>Go to active search result</dd>
            </dl>
        </div>
        <div class="infos">
            <h1>Search tricks</h1>
            <p>
                Prefix searches with a type followed by a colon (e.g.
                <code>fn:</code>) to restrict the search to a given type.
            </p>
            <p>
                Accepted types are: <code>fn</code>, <code>mod</code>,
                <code>struct</code>, <code>enum</code>,
                <code>trait</code>, <code>typedef</code> (or
                <code>tdef</code>).
            </p>
        </div>
    </div>

    

    <script>
        window.rootPath = "../../";
        window.currentCrate = "glium";
        window.playgroundUrl = "";
    </script>
    <script src="../../jquery.js"></script>
    <script src="../../main.js"></script>
    
    <script async src="../../search-index.js"></script>
</body>
</html>